{"version":3,"sources":["file:///Users/phuongduy/CardDeck/assets/scripts/Managers/BetManager.ts"],"names":["_decorator","Component","CCInteger","ChipEntry","EventManager","GameEvent","ccclass","property","BetManager","type","selectedChips","currentBet","start","instance","gameEvents","on","CHIP_SELECTED","addChip","GAME_RESET","clearBet","emit","CHIP_ENTRY_READY","chips","onDestroy","off","chip","value","maxBet","console","warn","push","Number","log","ADD_CHIP_UI","UPDATE_BET_VALUE","getTotalBet","getSelectedChips"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,S,OAAAA,S;;AAEvBC,MAAAA,S,iBAAAA,S;;AACAC,MAAAA,Y,iBAAAA,Y;;AACAC,MAAAA,S,iBAAAA,S;;;;;;;;;OAHH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBP,U;;4BAMjBQ,U,WADZF,OAAO,CAAC,YAAD,C,UAEHC,QAAQ,CAAC;AAAEE,QAAAA,IAAI,EAAE;AAAA;AAAA;AAAR,OAAD,C,UAGRF,QAAQ,CAAC;AAACE,QAAAA,IAAI,EAAEP;AAAP,OAAD,C,2BALb,MACaM,UADb,SACgCP,SADhC,CAC0C;AAAA;AAAA;;AAAA;;AAAA;;AAAA,eAO9BS,aAP8B,GAOD,EAPC;AAAA,eAQ9BC,UAR8B,GAQT,CARS;AAAA;;AAUtCC,QAAAA,KAAK,GAAG;AACJ;AAAA;AAAA,4CAAaC,QAAb,CAAsBC,UAAtB,CAAiCC,EAAjC,CAAoC;AAAA;AAAA,sCAAUC,aAA9C,EAA6D,KAAKC,OAAlE,EAA2E,IAA3E;AACA;AAAA;AAAA,4CAAaJ,QAAb,CAAsBC,UAAtB,CAAiCC,EAAjC,CAAoC;AAAA;AAAA,sCAAUG,UAA9C,EAA0D,KAAKC,QAA/D,EAAyE,IAAzE;AACA;AAAA;AAAA,4CAAaN,QAAb,CAAsBC,UAAtB,CAAiCM,IAAjC,CAAsC;AAAA;AAAA,sCAAUC,gBAAhD,EAAkE,KAAKC,KAAvE,EAA8E,IAA9E;AACH;;AAEDC,QAAAA,SAAS,GAAG;AACR;AAAA;AAAA,4CAAaV,QAAb,CAAsBC,UAAtB,CAAiCU,GAAjC,CAAqC;AAAA;AAAA,sCAAUR,aAA/C,EAA8D,KAAKC,OAAnE,EAA4E,IAA5E;AACH;;AAEMA,QAAAA,OAAO,CAACQ,IAAD,EAAkB;AAC5B,cAAI,KAAKd,UAAL,GAAkBc,IAAI,CAACC,KAAvB,GAA+B,KAAKC,MAAxC,EAAgD;AAC5CC,YAAAA,OAAO,CAACC,IAAR,CAAa,iBAAb;AACA;AACH;;AAED,eAAKnB,aAAL,CAAmBoB,IAAnB,CAAwBL,IAAxB;AACA,eAAKd,UAAL,IAAmBoB,MAAM,CAACN,IAAI,CAACC,KAAN,CAAzB;AACAE,UAAAA,OAAO,CAACI,GAAR,CAAY,kBAAkB,KAAKrB,UAAnC;AACA;AAAA;AAAA,4CAAaE,QAAb,CAAsBC,UAAtB,CAAiCM,IAAjC,CAAsC;AAAA;AAAA,sCAAUa,WAAhD,EAA6DR,IAA7D,EAAmE,IAAnE;AACA;AAAA;AAAA,4CAAaZ,QAAb,CAAsBC,UAAtB,CAAiCM,IAAjC,CAAsC;AAAA;AAAA,sCAAUc,gBAAhD,EAAkE,KAAKvB,UAAvE,EAAmF,IAAnF;AACH;;AAEMQ,QAAAA,QAAQ,GAAG;AACd,eAAKT,aAAL,GAAqB,EAArB;AACA,eAAKC,UAAL,GAAkB,CAAlB;AACA;AAAA;AAAA,4CAAaE,QAAb,CAAsBC,UAAtB,CAAiCM,IAAjC,CAAsC;AAAA;AAAA,sCAAUc,gBAAhD,EAAkE,KAAKvB,UAAvE,EAAmF,IAAnF;AACH;;AAEMwB,QAAAA,WAAW,GAAW;AACzB,iBAAO,KAAKxB,UAAZ;AACH;;AAEMyB,QAAAA,gBAAgB,GAAgB;AACnC,iBAAO,CAAC,GAAG,KAAK1B,aAAT,CAAP;AACH;;AA7CqC,O;;;;;iBAET,E;;;;;;;iBAGJ,G","sourcesContent":["import { _decorator, Component, CCInteger } from 'cc';\nconst { ccclass, property } = _decorator;\nimport { ChipEntry } from '../Chip/ChipEntry';\nimport { EventManager } from './EventManager';\nimport { GameEvent } from '../enums/GameEvent';\n\n@ccclass('BetManager')\nexport class BetManager extends Component {\n    @property({ type: [ChipEntry] })\n    private chips: ChipEntry[] = [];\n\n    @property({type: CCInteger})\n    private maxBet: number = 500;\n\n    private selectedChips: ChipEntry[] = [];\n    private currentBet: number = 0;\n\n    start() {\n        EventManager.instance.gameEvents.on(GameEvent.CHIP_SELECTED, this.addChip, this);\n        EventManager.instance.gameEvents.on(GameEvent.GAME_RESET, this.clearBet, this);\n        EventManager.instance.gameEvents.emit(GameEvent.CHIP_ENTRY_READY, this.chips, this);\n    }\n\n    onDestroy() {\n        EventManager.instance.gameEvents.off(GameEvent.CHIP_SELECTED, this.addChip, this);\n    }\n\n    public addChip(chip: ChipEntry) {\n        if (this.currentBet + chip.value > this.maxBet) {\n            console.warn(\"Max bet reached\");\n            return;\n        }\n\n        this.selectedChips.push(chip);\n        this.currentBet += Number(chip.value);\n        console.log('Current bet: ' + this.currentBet);\n        EventManager.instance.gameEvents.emit(GameEvent.ADD_CHIP_UI, chip, this);\n        EventManager.instance.gameEvents.emit(GameEvent.UPDATE_BET_VALUE, this.currentBet, this);\n    }\n\n    public clearBet() {\n        this.selectedChips = [];\n        this.currentBet = 0;\n        EventManager.instance.gameEvents.emit(GameEvent.UPDATE_BET_VALUE, this.currentBet, this);\n    }\n\n    public getTotalBet(): number {\n        return this.currentBet;\n    }\n\n    public getSelectedChips(): ChipEntry[] {\n        return [...this.selectedChips];\n    }\n\n}\n\n"]}