{"version":3,"sources":["file:///Users/phuongduy/CardDeck/assets/scripts/Managers/UIManager.ts"],"names":["_decorator","Button","Component","Node","Prefab","instantiate","Vec3","Label","tween","Vec2","EventManager","GameEvent","Card","Player","Dealer","ChipButton","SFXID","ccclass","property","MAX_STACK_COUNT","MAX_STACK_PER_TYPE","UIManager","chipButtons","chipStacks","Map","chipStackPositions","playerAnimationInProgress","dealerAnimationInProgress","playerHandCount","start","instance","gameEvents","on","CHIP_ENTRY_READY","setupChipButtons","ADD_CHIP_UI","addChip","UPDATE_BET_VALUE","updateBetValue","GAME_STARTED","onGameStarted","DEAL_CARD","addCardToParticipant","SPLIT_HAND","animateSplitHand","CHANGE_HAND","changeHand","GAME_ENDED","displayResult","GAME_RESET","resetUI","DEALER_TURN_END","flipDealerCards","LOCK_INPUT","lockInput","UNLOCK_INPUT","unlockInput","attachPlaySFXToButton","node","parent","console","log","dealButton","interactable","active","hitButton","standButton","doubleButton","resultLabel","resetButton","splitButton","playerScoreLabels","forEach","playerScoreLabel","dealerScoreLabel","playerCardContainers","playerCardContainer","removeAllChildren","dealerCardContainer","chipButton","setInteractable","handIndicators","handIndicator","potArea","resetPot","onDestroy","off","chipEntries","i","length","entry","chipNode","chipButtonPrefab","setParent","bettingArea","getComponent","push","setup","setPosition","chipEntry","baseX","baseY","offsetX","offsetY","stackPositionY","has","value","set","size","stackCount","get","stackPositionX","x","y","potResetButton","betValue","totalBet","string","clear","emit","PLAY_SFX","Chip","player","canSplit","participant","handArea","handIndex","getIndex","hand","getHand","children","animateCardToHand","ANIMATION_FINISHED","CardDeal","displayedCardCount","latestCardData","cardNode","cardPrefab","card","addComponent","init","scoreLabel","isFaceDown","revealAll","addChild","setWorldPosition","deckPosition","getWorldPosition","targetPos","getCardTargetPosition","Promise","resolve","to","position","call","flipCard","checkRemainingAnimation","getHandValue","dealerCardNodes","originHandArea","targetHandArea","targetCard","worldPos","worldPosition","clone","removeFromParent","cardIndex","xOffset","yOffset","Math","floor","result","root","buttons","getComponentsInChildren","button","EventType","CLICK","playButtonSFX","ButtonClick"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,K,OAAAA,K;AAAoBC,MAAAA,I,OAAAA,I;;AAC3FC,MAAAA,Y,iBAAAA,Y;;AACAC,MAAAA,S,iBAAAA,S;;AACAC,MAAAA,I,iBAAAA,I;;AAGAC,MAAAA,M,iBAAAA,M;;AACAC,MAAAA,M,iBAAAA,M;;AAGAC,MAAAA,U,iBAAAA,U;;AAEAC,MAAAA,K,iBAAAA,K;;;;;;;;;OAEH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBlB,U;AAExBmB,MAAAA,e,GAAkB,C;AAClBC,MAAAA,kB,GAAqB,C;;2BAGdC,S,WADZJ,OAAO,CAAC,WAAD,C,UAGHC,QAAQ,CAACd,MAAD,C,UAGRc,QAAQ,CAACX,KAAD,C,UAGRW,QAAQ,CAACjB,MAAD,C,UAGRiB,QAAQ,CAACjB,MAAD,C,UAGRiB,QAAQ,CAACjB,MAAD,C,UAGRiB,QAAQ,CAACjB,MAAD,C,UAGRiB,QAAQ,CAACjB,MAAD,C,UAGRiB,QAAQ,CAACjB,MAAD,C,WAGRiB,QAAQ,CAACf,IAAD,C,WAGRe,QAAQ,CAACf,IAAD,C,WAGRe,QAAQ,CAACX,KAAD,C,WAGRW,QAAQ,CAACf,IAAD,C,WAGRe,QAAQ,CAACX,KAAD,C,WAGRW,QAAQ,CAACf,IAAD,C,WAGRe,QAAQ,CAACjB,MAAD,C,WAGRiB,QAAQ,CAACf,IAAD,C,WAGRe,QAAQ,CAACf,IAAD,C,WAGRe,QAAQ,CAACd,MAAD,C,WAGRc,QAAQ,CAACX,KAAD,C,2BAzDb,MACac,SADb,SAC+BnB,SAD/B,CACyC;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA,eA2D7BoB,WA3D6B,GA2DD,EA3DC;AAAA,eA4D7BC,UA5D6B,GA4DK,IAAIC,GAAJ,EA5DL;AAAA,eA6D7BC,kBA7D6B,GA6DW,IAAID,GAAJ,EA7DX;AAAA,eA+D7BE,yBA/D6B,GA+DO,CA/DP;AAAA,eAgE7BC,yBAhE6B,GAgEO,CAhEP;AAAA,eAkE7BC,eAlE6B,GAkEX,CAlEW;AAAA;;AAoErCC,QAAAA,KAAK,GAAG;AACJ;AAAA;AAAA,4CAAaC,QAAb,CAAsBC,UAAtB,CAAiCC,EAAjC,CAAoC;AAAA;AAAA,sCAAUC,gBAA9C,EAAgE,KAAKC,gBAArE,EAAuF,IAAvF;AACA;AAAA;AAAA,4CAAaJ,QAAb,CAAsBC,UAAtB,CAAiCC,EAAjC,CAAoC;AAAA;AAAA,sCAAUG,WAA9C,EAA2D,KAAKC,OAAhE,EAAyE,IAAzE;AACA;AAAA;AAAA,4CAAaN,QAAb,CAAsBC,UAAtB,CAAiCC,EAAjC,CAAoC;AAAA;AAAA,sCAAUK,gBAA9C,EAAgE,KAAKC,cAArE,EAAqF,IAArF;AACA;AAAA;AAAA,4CAAaR,QAAb,CAAsBC,UAAtB,CAAiCC,EAAjC,CAAoC;AAAA;AAAA,sCAAUO,YAA9C,EAA4D,KAAKC,aAAjE,EAAgF,IAAhF;AACA;AAAA;AAAA,4CAAaV,QAAb,CAAsBC,UAAtB,CAAiCC,EAAjC,CAAoC;AAAA;AAAA,sCAAUS,SAA9C,EAAyD,KAAKC,oBAA9D,EAAoF,IAApF;AACA;AAAA;AAAA,4CAAaZ,QAAb,CAAsBC,UAAtB,CAAiCC,EAAjC,CAAoC;AAAA;AAAA,sCAAUW,UAA9C,EAA0D,KAAKC,gBAA/D,EAAiF,IAAjF;AACA;AAAA;AAAA,4CAAad,QAAb,CAAsBC,UAAtB,CAAiCC,EAAjC,CAAoC;AAAA;AAAA,sCAAUa,WAA9C,EAA2D,KAAKC,UAAhE,EAA4E,IAA5E;AACA;AAAA;AAAA,4CAAahB,QAAb,CAAsBC,UAAtB,CAAiCC,EAAjC,CAAoC;AAAA;AAAA,sCAAUe,UAA9C,EAA0D,KAAKC,aAA/D,EAA8E,IAA9E;AACA;AAAA;AAAA,4CAAalB,QAAb,CAAsBC,UAAtB,CAAiCC,EAAjC,CAAoC;AAAA;AAAA,sCAAUiB,UAA9C,EAA0D,KAAKC,OAA/D,EAAwE,IAAxE;AACA;AAAA;AAAA,4CAAapB,QAAb,CAAsBC,UAAtB,CAAiCC,EAAjC,CAAoC;AAAA;AAAA,sCAAUmB,eAA9C,EAA+D,KAAKC,eAApE,EAAqF,IAArF;AACA;AAAA;AAAA,4CAAatB,QAAb,CAAsBC,UAAtB,CAAiCC,EAAjC,CAAoC;AAAA;AAAA,sCAAUqB,UAA9C,EAA0D,KAAKC,SAA/D,EAA0E,IAA1E;AACA;AAAA;AAAA,4CAAaxB,QAAb,CAAsBC,UAAtB,CAAiCC,EAAjC,CAAoC;AAAA;AAAA,sCAAUuB,YAA9C,EAA4D,KAAKC,WAAjE,EAA8E,IAA9E;AAEA,eAAKC,qBAAL,CAA2B,KAAKC,IAAL,CAAUC,MAArC;AACA,eAAKT,OAAL;AACH;;AAEOA,QAAAA,OAAO,GAAG;AACdU,UAAAA,OAAO,CAACC,GAAR,CAAY,iBAAZ;AACA,eAAKC,UAAL,CAAgBC,YAAhB,GAA+B,KAA/B;AACA,eAAKD,UAAL,CAAgBJ,IAAhB,CAAqBM,MAArB,GAA8B,IAA9B;AACA,eAAKC,SAAL,CAAeP,IAAf,CAAoBM,MAApB,GAA6B,KAA7B;AACA,eAAKE,WAAL,CAAiBR,IAAjB,CAAsBM,MAAtB,GAA+B,KAA/B;AACA,eAAKG,YAAL,CAAkBT,IAAlB,CAAuBM,MAAvB,GAAgC,KAAhC;AACA,eAAKI,WAAL,CAAiBV,IAAjB,CAAsBM,MAAtB,GAA+B,KAA/B;AACA,eAAKK,WAAL,CAAiBX,IAAjB,CAAsBM,MAAtB,GAA+B,KAA/B;AACA,eAAKM,WAAL,CAAiBZ,IAAjB,CAAsBM,MAAtB,GAA+B,KAA/B;AACA,eAAKO,iBAAL,CAAuBC,OAAvB,CAA+BC,gBAAgB,IAAI;AAC/CA,YAAAA,gBAAgB,CAACf,IAAjB,CAAsBM,MAAtB,GAA+B,KAA/B;AACH,WAFD;AAGA,eAAKU,gBAAL,CAAsBhB,IAAtB,CAA2BM,MAA3B,GAAoC,KAApC;AAEA,eAAKW,oBAAL,CAA0BH,OAA1B,CAAkCI,mBAAmB,IAAI;AACrDA,YAAAA,mBAAmB,CAACC,iBAApB;AACH,WAFD;AAGA,eAAKC,mBAAL,CAAyBD,iBAAzB;AAEA,eAAKvD,WAAL,CAAiBkD,OAAjB,CAAyBO,UAAU,IAAI;AACnCA,YAAAA,UAAU,CAACC,eAAX,CAA2B,IAA3B;AACH,WAFD;AAIA,eAAKC,cAAL,CAAoBT,OAApB,CAA4BU,aAAa,IAAI;AACzCA,YAAAA,aAAa,CAAClB,MAAd,GAAuB,KAAvB;AACH,WAFD;AAGA,eAAKmB,OAAL,CAAaN,iBAAb;AACA,eAAKO,QAAL;AACA,eAAKxD,eAAL,GAAuB,CAAvB;AACH;;AAESyD,QAAAA,SAAS,GAAS;AACxB;AAAA;AAAA,4CAAavD,QAAb,CAAsBC,UAAtB,CAAiCuD,GAAjC,CAAqC;AAAA;AAAA,sCAAUrD,gBAA/C,EAAiE,KAAKC,gBAAtE,EAAwF,IAAxF;AACA;AAAA;AAAA,4CAAaJ,QAAb,CAAsBC,UAAtB,CAAiCuD,GAAjC,CAAqC;AAAA;AAAA,sCAAUnD,WAA/C,EAA4D,KAAKC,OAAjE,EAA0E,IAA1E;AACA;AAAA;AAAA,4CAAaN,QAAb,CAAsBC,UAAtB,CAAiCuD,GAAjC,CAAqC;AAAA;AAAA,sCAAUjD,gBAA/C,EAAiE,KAAKC,cAAtE,EAAsF,IAAtF;AACA;AAAA;AAAA,4CAAaR,QAAb,CAAsBC,UAAtB,CAAiCuD,GAAjC,CAAqC;AAAA;AAAA,sCAAU/C,YAA/C,EAA6D,KAAKC,aAAlE,EAAiF,IAAjF;AACA;AAAA;AAAA,4CAAaV,QAAb,CAAsBC,UAAtB,CAAiCuD,GAAjC,CAAqC;AAAA;AAAA,sCAAU7C,SAA/C,EAA0D,KAAKC,oBAA/D,EAAqF,IAArF;AACA;AAAA;AAAA,4CAAaZ,QAAb,CAAsBC,UAAtB,CAAiCuD,GAAjC,CAAqC;AAAA;AAAA,sCAAUvC,UAA/C,EAA2D,KAAKC,aAAhE,EAA+E,IAA/E;AACA;AAAA;AAAA,4CAAalB,QAAb,CAAsBC,UAAtB,CAAiCuD,GAAjC,CAAqC;AAAA;AAAA,sCAAUrC,UAA/C,EAA2D,KAAKC,OAAhE,EAAyE,IAAzE;AACA;AAAA;AAAA,4CAAapB,QAAb,CAAsBC,UAAtB,CAAiCuD,GAAjC,CAAqC;AAAA;AAAA,sCAAUnC,eAA/C,EAAgE,KAAKC,eAArE,EAAsF,IAAtF;AACH;;AAEOlB,QAAAA,gBAAgB,CAACqD,WAAD,EAA2B;AAC/C,eAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,WAAW,CAACE,MAAhC,EAAwCD,CAAC,EAAzC,EAA6C;AACzC,gBAAME,KAAK,GAAGH,WAAW,CAACC,CAAD,CAAzB;AACA,gBAAMG,QAAQ,GAAGtF,WAAW,CAAC,KAAKuF,gBAAN,CAA5B;AACAD,YAAAA,QAAQ,CAACE,SAAT,CAAmB,KAAKC,WAAxB;AAEA,gBAAMf,UAAU,GAAGY,QAAQ,CAACI,YAAT;AAAA;AAAA,yCAAnB;AACA,iBAAKzE,WAAL,CAAiB0E,IAAjB,CAAsBjB,UAAtB;AACAA,YAAAA,UAAU,CAACkB,KAAX,CAAiBP,KAAjB;AACAC,YAAAA,QAAQ,CAACO,WAAT,CAAqB,CAArB,EAAwB,CAAxB;AACH;AACJ;;AAEO9D,QAAAA,OAAO,CAAC+D,SAAD,EAAuB;AAClC,cAAMC,KAAK,GAAG,CAAd;AACA,cAAMC,KAAK,GAAG,CAAd;AACA,cAAMC,OAAO,GAAG,EAAhB;AACA,cAAMC,OAAO,GAAG,EAAhB,CAJkC,CAMlC;;AACA,cAAIC,cAAc,GAAG,CAArB;;AACA,cAAI,CAAC,KAAK/E,kBAAL,CAAwBgF,GAAxB,CAA4BN,SAAS,CAACO,KAAtC,CAAL,EAAmD;AAC/C,iBAAKnF,UAAL,CAAgBoF,GAAhB,CAAoBR,SAAS,CAACO,KAA9B,EAAqC,CAArC;AACA,iBAAKjF,kBAAL,CAAwBkF,GAAxB,CAA4BR,SAAS,CAACO,KAAtC,EAA6C,IAAIjG,IAAJ,CAAS,KAAKgB,kBAAL,CAAwBmF,IAAjC,EAAuC,CAAvC,CAA7C;AACH;;AAED,cAAIC,UAAU,GAAG,KAAKtF,UAAL,CAAgBuF,GAAhB,CAAoBX,SAAS,CAACO,KAA9B,CAAjB;AACA,cAAIK,cAAc,GAAG,KAAKtF,kBAAL,CAAwBqF,GAAxB,CAA4BX,SAAS,CAACO,KAAtC,EAA6CM,CAAlE;AACAR,UAAAA,cAAc,GAAG,KAAK/E,kBAAL,CAAwBqF,GAAxB,CAA4BX,SAAS,CAACO,KAAtC,EAA6CO,CAA7C,GAAiD,CAAlE;;AACA,cAAIJ,UAAU,IAAIzF,kBAAkB,GAAGD,eAAvC,EAAwD;AACpDyC,YAAAA,OAAO,CAACC,GAAR,CAAY,uDAAZ;AACA;AACH;;AACD,cAAIgD,UAAU,GAAG1F,eAAb,IAAgC,CAApC,EAAuC;AACnCqF,YAAAA,cAAc,GAAGA,cAAc,GAAGrF,eAAjB,GAAmC,CAApD;AACH;;AAED,cAAMwE,QAAQ,GAAGtF,WAAW,CAAC,KAAKuF,gBAAN,CAA5B;AACAD,UAAAA,QAAQ,CAACE,SAAT,CAAmB,KAAKV,OAAxB;AACA,cAAMJ,UAAU,GAAGY,QAAQ,CAACI,YAAT;AAAA;AAAA,uCAAnB;AACAhB,UAAAA,UAAU,CAACkB,KAAX,CAAiBE,SAAjB;AACApB,UAAAA,UAAU,CAACC,eAAX,CAA2B,KAA3B;AAEAW,UAAAA,QAAQ,CAACO,WAAT,CAAqBE,KAAK,GAAGW,cAAc,GAAGT,OAA9C,EAAuDD,KAAK,GAAGG,cAAc,GAAGD,OAAhF;AACA,eAAKhF,UAAL,CAAgBoF,GAAhB,CAAoBR,SAAS,CAACO,KAA9B,EAAqCG,UAAU,GAAG,CAAlD;AACA,eAAKpF,kBAAL,CAAwBkF,GAAxB,CAA4BR,SAAS,CAACO,KAAtC,EAA6C,IAAIjG,IAAJ,CAASsG,cAAT,EAAyBP,cAAzB,CAA7C;AAEA,eAAKU,cAAL,CAAoBnD,YAApB,GAAmC,IAAnC;AACH;;AAEOzB,QAAAA,cAAc,CAAC6E,QAAD,EAAmB;AACrC,eAAKC,QAAL,CAAcC,MAAd,GAAuB,WAAWF,QAAlC;;AACA,cAAIA,QAAQ,GAAG,CAAf,EAAkB;AACd,iBAAKrD,UAAL,CAAgBC,YAAhB,GAA+B,IAA/B;AACH,WAFD,MAEO;AACH,iBAAKD,UAAL,CAAgBC,YAAhB,GAA+B,KAA/B;AACA,iBAAKqB,QAAL;AACH;AACJ;;AAEOA,QAAAA,QAAQ,GAAG;AACf,eAAKD,OAAL,CAAaN,iBAAb;AACA,eAAKtD,UAAL,CAAgB+F,KAAhB;AACA,eAAK7F,kBAAL,CAAwB6F,KAAxB;AACA,eAAKJ,cAAL,CAAoBnD,YAApB,GAAmC,KAAnC;AAEA;AAAA;AAAA,4CAAajC,QAAb,CAAsBC,UAAtB,CAAiCwF,IAAjC,CAAsC;AAAA;AAAA,sCAAUC,QAAhD,EAA0D;AAAA;AAAA,8BAAMC,IAAhE,EAAsE,IAAtE;AACH;;AAEOjF,QAAAA,aAAa,CAACkF,MAAD,EAAiB;AAClC,eAAK5D,UAAL,CAAgBJ,IAAhB,CAAqBM,MAArB,GAA8B,KAA9B;AACA,eAAKC,SAAL,CAAeP,IAAf,CAAoBM,MAApB,GAA6B,IAA7B;AACA,eAAKE,WAAL,CAAiBR,IAAjB,CAAsBM,MAAtB,GAA+B,IAA/B;AACA,eAAKG,YAAL,CAAkBT,IAAlB,CAAuBM,MAAvB,GAAgC,IAAhC;AACA,eAAK1C,WAAL,CAAiBkD,OAAjB,CAAyBO,UAAU,IAAI;AACnCA,YAAAA,UAAU,CAACC,eAAX,CAA2B,KAA3B;AACH,WAFD;AAGA,eAAKV,WAAL,CAAiBZ,IAAjB,CAAsBM,MAAtB,GAA+B,IAA/B;;AACA,cAAI0D,MAAM,CAACC,QAAP,EAAJ,EAAuB;AACnB,iBAAKrD,WAAL,CAAiBP,YAAjB,GAAgC,IAAhC;AACH,WAFD,MAEO;AACH,iBAAKO,WAAL,CAAiBP,YAAjB,GAAgC,KAAhC;AACH;;AACD,eAAKnC,eAAL;AACH;;AAEKc,QAAAA,oBAAoB,CAACkF,WAAD,EAA2B;AAAA;;AAAA;AACjD,YAAA,KAAI,CAACV,cAAL,CAAoBnD,YAApB,GAAmC,KAAnC;AAEA,gBAAI8D,QAAQ,GAAG,IAAf;;AACA,gBAAID,WAAW;AAAA;AAAA,iCAAf,EAAmC;AAC/B,kBAAME,SAAS,GAAGF,WAAW,CAACG,QAAZ,EAAlB;AACAF,cAAAA,QAAQ,GAAG,KAAI,CAAClD,oBAAL,CAA0BmD,SAA1B,CAAX;AACH,aAHD,MAGO,IAAIF,WAAW;AAAA;AAAA,iCAAf,EAAmC;AACtCC,cAAAA,QAAQ,GAAG,KAAI,CAAC/C,mBAAhB;AACH;;AAED,gBAAMkD,IAAI,GAAGJ,WAAW,CAACK,OAAZ,EAAb;;AACA,iBAAK,IAAIzC,CAAC,GAAGqC,QAAQ,CAACK,QAAT,CAAkBzC,MAA/B,EAAuCD,CAAC,GAAGwC,IAAI,CAACvC,MAAhD,EAAwDD,CAAC,EAAzD,EAA6D;AACzD,oBAAM,KAAI,CAAC2C,iBAAL,CAAuBP,WAAvB,EAAoCC,QAApC,CAAN;AACH;;AACD;AAAA;AAAA,8CAAa/F,QAAb,CAAsBC,UAAtB,CAAiCwF,IAAjC,CAAsC;AAAA;AAAA,wCAAUa,kBAAhD,EAAoER,WAApE;AAfiD;AAgBpD;;AAEKO,QAAAA,iBAAiB,CAACP,WAAD,EAA2BC,QAA3B,EAA0D;AAAA;;AAAA;AAC7E;AAAA;AAAA,8CAAa/F,QAAb,CAAsBC,UAAtB,CAAiCwF,IAAjC,CAAsC;AAAA;AAAA,wCAAUC,QAAhD,EAA0D;AAAA;AAAA,gCAAMa,QAAhE;AAEA,gBAAML,IAAI,GAAGJ,WAAW,CAACK,OAAZ,EAAb;AACA,gBAAMK,kBAAkB,GAAGT,QAAQ,CAACK,QAAT,CAAkBzC,MAA7C;;AACA,gBAAI6C,kBAAkB,IAAIN,IAAI,CAACvC,MAA/B,EAAuC;AACnC;AACH;;AACD,gBAAM8C,cAAc,GAAGP,IAAI,CAACM,kBAAD,CAA3B,CAR6E,CAU7E;;AACA,gBAAME,QAAQ,GAAGnI,WAAW,CAAC,MAAI,CAACoI,UAAN,CAA5B;AACA,gBAAIC,IAAI,GAAGF,QAAQ,CAACG,YAAT;AAAA;AAAA,6BAAX;AACAD,YAAAA,IAAI,CAACE,IAAL,CAAUL,cAAV,EAb6E,CAe7E;;AACA,gBAAIM,UAAJ;;AACA,gBAAIjB,WAAW;AAAA;AAAA,iCAAf,EAAmC;AAC/BW,cAAAA,cAAc,CAACO,UAAf,GAA4B,KAA5B;AACA,cAAA,MAAI,CAACpH,yBAAL;AACA,kBAAMoG,SAAS,GAAGF,WAAW,CAACG,QAAZ,EAAlB;AACAc,cAAAA,UAAU,GAAG,MAAI,CAACtE,iBAAL,CAAuBuD,SAAvB,CAAb;AACH,aALD,MAKO,IAAIF,WAAW;AAAA;AAAA,iCAAf,EAAmC;AACtCW,cAAAA,cAAc,CAACO,UAAf,GAA6BR,kBAAkB,KAAK,CAAvB,IAA4B,CAACV,WAAW,CAACmB,SAAtE;AACA,cAAA,MAAI,CAACpH,yBAAL;AACAkH,cAAAA,UAAU,GAAG,MAAI,CAACnE,gBAAlB;AACH;;AACDmD,YAAAA,QAAQ,CAACmB,QAAT,CAAkBR,QAAlB,EA3B6E,CA6B7E;;AACAA,YAAAA,QAAQ,CAACS,gBAAT,CAA0B,MAAI,CAACC,YAAL,CAAkBC,gBAAlB,EAA1B,EA9B6E,CAgC7E;;AACA,gBAAMC,SAAS,GAAG,MAAI,CAACC,qBAAL,CAA2Bf,kBAA3B,CAAlB;;AACA,kBAAM,IAAIgB,OAAJ,CAAmBC,OAAD,IAAa;AACjC/I,cAAAA,KAAK,CAACgI,QAAD,CAAL,CACCgB,EADD,CACI,GADJ,EACS;AAAEC,gBAAAA,QAAQ,EAAEL;AAAZ,eADT,EAECM,IAFD,iCAEM,aAAY;AACd,oBAAI,CAACnB,cAAc,CAACO,UAApB,EAAgC;AAC5B,sBAAIlB,WAAW;AAAA;AAAA,uCAAf,EAAmC;AAC/BhE,oBAAAA,OAAO,CAACC,GAAR,CAAY,sBAAZ;AACH;;AACD,wBAAM6E,IAAI,CAACiB,QAAL,EAAN;;AACA,sBAAI/B,WAAW;AAAA;AAAA,uCAAf,EAAmC;AAC/BhE,oBAAAA,OAAO,CAACC,GAAR,CAAY,2BAAZ;AACH;;AACD,kBAAA,MAAI,CAAC+F,uBAAL,CAA6BhC,WAA7B;;AACAiB,kBAAAA,UAAU,CAACxB,MAAX,GAAoB,iBAAiBO,WAAW,CAACiC,YAAZ,EAArC;AACH;AACJ,eAdD,GAeCH,IAfD,CAeMH,OAfN,EAgBC1H,KAhBD;AAiBH,aAlBK,CAAN;AAlC6E;AAqDhF;;AAEKuB,QAAAA,eAAe,GAAG;AAAA;;AAAA;AACpB,gBAAM0G,eAAe,GAAG,MAAI,CAAChF,mBAAL,CAAyBoD,QAAjD;;AACA,iBAAK,IAAI1C,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGsE,eAAe,CAACrE,MAApC,EAA4CD,CAAC,EAA7C,EAAiD;AAC7C,kBAAMgD,QAAQ,GAAGsB,eAAe,CAAC,CAAD,CAAhC;AACA,kBAAMpB,IAAI,GAAGF,QAAQ,CAACzC,YAAT;AAAA;AAAA,+BAAb;;AACA,kBAAI2C,IAAI,CAACI,UAAT,EAAqB;AACjB,sBAAMJ,IAAI,CAACiB,QAAL,EAAN;;AACA,gBAAA,MAAI,CAACC,uBAAL,CAA6B;AAAA;AAAA,uCAA7B;AACH;AACJ;AATmB;AAUvB;;AAEKhH,QAAAA,gBAAgB,GAAG;AAAA;;AAAA;AACrB;AAAA;AAAA,8CAAad,QAAb,CAAsBC,UAAtB,CAAiCwF,IAAjC,CAAsC;AAAA;AAAA,wCAAUC,QAAhD,EAA0D;AAAA;AAAA,gCAAMa,QAAhE;AACA,gBAAM0B,cAAc,GAAG,MAAI,CAACpF,oBAAL,CAA0B,CAA1B,CAAvB;AACA,gBAAMqF,cAAc,GAAG,MAAI,CAACrF,oBAAL,CAA0B,CAA1B,CAAvB;AAEA,gBAAMsF,UAAU,GAAGF,cAAc,CAAC7B,QAAf,CAAwB,CAAxB,CAAnB;AACA,gBAAMgC,QAAQ,GAAGD,UAAU,CAACE,aAAX,CAAyBC,KAAzB,EAAjB;AACAH,YAAAA,UAAU,CAACI,gBAAX;AACAL,YAAAA,cAAc,CAAChB,QAAf,CAAwBiB,UAAxB;AACAA,YAAAA,UAAU,CAAChB,gBAAX,CAA4BiB,QAA5B;;AAEA,gBAAMd,SAAS,GAAG,MAAI,CAACC,qBAAL,CAA2B,CAA3B,CAAlB;;AACI,kBAAM,IAAIC,OAAJ,CAAmBC,OAAD,IAAa;AACjC/I,cAAAA,KAAK,CAACyJ,UAAD,CAAL,CACCT,EADD,CACI,GADJ,EACS;AAAEC,gBAAAA,QAAQ,EAAEL;AAAZ,eADT,EAECM,IAFD,CAEMH,OAFN,EAGC1H,KAHD;AAIP,aALS,CAAN;AAMJ,YAAA,MAAI,CAACyC,WAAL,CAAiBP,YAAjB,GAAgC,KAAhC;AACA,YAAA,MAAI,CAACkB,cAAL,CAAoB,CAApB,EAAuBjB,MAAvB,GAAgC,IAAhC;AACA,YAAA,MAAI,CAACpC,eAAL;AApBqB;AAqBxB;;AAEOkB,QAAAA,UAAU,CAACgF,SAAD,EAAoB;AAClC,cAAI,KAAKlG,eAAL,IAAwB,CAA5B,EAA+B;AAC/B,eAAKqD,cAAL,CAAoBT,OAApB,CAA4BU,aAAa,IAAI;AACzCA,YAAAA,aAAa,CAAClB,MAAd,GAAuB,KAAvB;AACH,WAFD;AAGA,eAAKiB,cAAL,CAAoB6C,SAApB,EAA+B9D,MAA/B,GAAwC,IAAxC;AACH;;AAEO4F,QAAAA,uBAAuB,CAAChC,WAAD,EAA2B;AACtD,cAAIA,WAAW;AAAA;AAAA,+BAAf,EAAmC;AAC/B,iBAAKlG,yBAAL;AACH,WAFD,MAEO,IAAIkG,WAAW;AAAA;AAAA,+BAAf,EAAmC;AACtC,iBAAKjG,yBAAL;AACH;;AACDiC,UAAAA,OAAO,CAACC,GAAR,CAAY,yBAAZ,EAAuC,KAAKnC,yBAA5C,EAAuE,yBAAvE,EAAkG,KAAKC,yBAAvG;;AACA,cAAK,KAAKD,yBAAL,IAAkC,CAAlC,IAAuCkG,WAAW;AAAA;AAAA,+BAAnD,IACC,KAAKjG,yBAAL,IAAkC,CAAlC,IAAuCiG,WAAW;AAAA;AAAA,+BADvD,EAC4E;AACxEhE,YAAAA,OAAO,CAACC,GAAR,CAAY,0BAAZ;AACA;AAAA;AAAA,8CAAa/B,QAAb,CAAsBC,UAAtB,CAAiCwF,IAAjC,CAAsC;AAAA;AAAA,wCAAUa,kBAAhD,EAAoER,WAApE;AACH;AACJ;;AAEOyB,QAAAA,qBAAqB,CAACiB,SAAD,EAA0B;AACnD,cAAMC,OAAO,GAAG,EAAhB;AACA,cAAMC,OAAO,GAAG,CAAC,EAAjB;AACA,cAAMxD,CAAC,GAAIsD,SAAS,GAAG,EAAb,GAAmBC,OAA7B;AACA,cAAMtD,CAAC,GAAGwD,IAAI,CAACC,KAAL,CAAWJ,SAAS,GAAG,EAAvB,IAA6BE,OAAvC;AACA,iBAAO,IAAIlK,IAAJ,CAAS0G,CAAT,EAAYC,CAAZ,EAAe,CAAf,CAAP;AACH;;AAEOjE,QAAAA,aAAa,CAAC2H,MAAD,EAAiB;AAClC;AACA/G,UAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA4B8G,MAA5B;AACA,eAAKvG,WAAL,CAAiBV,IAAjB,CAAsBM,MAAtB,GAA+B,IAA/B;AACA,eAAKI,WAAL,CAAiBiD,MAAjB,GAA0BsD,MAA1B;AACA,eAAK1G,SAAL,CAAeP,IAAf,CAAoBM,MAApB,GAA6B,KAA7B;AACA,eAAKE,WAAL,CAAiBR,IAAjB,CAAsBM,MAAtB,GAA+B,KAA/B;AACA,eAAKK,WAAL,CAAiBX,IAAjB,CAAsBM,MAAtB,GAA+B,IAA/B;AACA,eAAKG,YAAL,CAAkBT,IAAlB,CAAuBM,MAAvB,GAAgC,KAAhC;AACA,eAAKM,WAAL,CAAiBZ,IAAjB,CAAsBM,MAAtB,GAA+B,KAA/B;;AAEA,eAAK,IAAIwB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK5D,eAAzB,EAA0C4D,CAAC,EAA3C,EAA+C;AAC3C,iBAAKjB,iBAAL,CAAuBiB,CAAvB,EAA0B9B,IAA1B,CAA+BM,MAA/B,GAAwC,IAAxC;AACH;;AAED,eAAKiB,cAAL,CAAoBT,OAApB,CAA4BU,aAAa,IAAI;AACzCA,YAAAA,aAAa,CAAClB,MAAd,GAAuB,KAAvB;AACH,WAFD;AAGA,eAAKU,gBAAL,CAAsBhB,IAAtB,CAA2BM,MAA3B,GAAoC,IAApC;AACH;;AAEOP,QAAAA,qBAAqB,CAACmH,IAAD,EAAa;AACtC,cAAMC,OAAO,GAAGD,IAAI,CAACE,uBAAL,CAA6B7K,MAA7B,CAAhB;;AACA,eAAK,IAAM8K,MAAX,IAAqBF,OAArB,EAA8B;AAC1BE,YAAAA,MAAM,CAACrH,IAAP,CAAY1B,EAAZ,CAAe/B,MAAM,CAAC+K,SAAP,CAAiBC,KAAhC,EAAuC,KAAKC,aAA5C,EAA2D,IAA3D;AACH;AACJ;;AAEOA,QAAAA,aAAa,GAAG;AACpB;AAAA;AAAA,4CAAapJ,QAAb,CAAsBC,UAAtB,CAAiCwF,IAAjC,CAAsC;AAAA;AAAA,sCAAUC,QAAhD,EAA0D;AAAA;AAAA,8BAAM2D,WAAhE;AACH;;AAEO7H,QAAAA,SAAS,GAAG;AAChB,eAAKQ,UAAL,CAAgBC,YAAhB,GAA+B,KAA/B;AACA,eAAKE,SAAL,CAAeF,YAAf,GAA8B,KAA9B;AACA,eAAKG,WAAL,CAAiBH,YAAjB,GAAgC,KAAhC;AACA,eAAKI,YAAL,CAAkBJ,YAAlB,GAAiC,KAAjC;AACA,eAAKM,WAAL,CAAiBN,YAAjB,GAAgC,KAAhC;AACA,eAAKO,WAAL,CAAiBP,YAAjB,GAAgC,KAAhC;AACH;;AAEOP,QAAAA,WAAW,GAAG;AAClB,eAAKM,UAAL,CAAgBC,YAAhB,GAA+B,IAA/B;AACA,eAAKE,SAAL,CAAeF,YAAf,GAA8B,IAA9B;AACA,eAAKG,WAAL,CAAiBH,YAAjB,GAAgC,IAAhC;AACA,eAAKI,YAAL,CAAkBJ,YAAlB,GAAiC,IAAjC;AACA,eAAKM,WAAL,CAAiBN,YAAjB,GAAgC,IAAhC;AACH;;AAhZoC,O;;;;;iBAGR,I;;;;;;;iBAGA,I;;;;;;;iBAGA,I;;;;;;;iBAGD,I;;;;;;;iBAGE,I;;;;;;;iBAGC,I;;;;;;;iBAGD,I;;;;;;;iBAGA,I;;;;;;;iBAGD,I;;;;;;;iBAGU,E;;;;;;;iBAGF,E;;;;;;;iBAGJ,E;;;;;;;iBAGC,I;;;;;;;iBAGE,I;;;;;;;iBAGH,I;;;;;;;iBAGL,I;;;;;;;iBAGJ,I;;;;;;;iBAGW,I;;;;;;;iBAGT,I","sourcesContent":["import { _decorator, Button, Component, Node, Prefab, instantiate, Vec3, Label, tween, UITransform, Vec2, Game } from 'cc';\nimport { EventManager } from './EventManager';\nimport { GameEvent } from '../enums/GameEvent';\nimport { Card } from '../Card';\n\nimport { Participant } from '../Participant';\nimport { Player } from '../Player';\nimport { Dealer } from '../Dealer';\n\nimport { ChipEntry } from '../Chip/ChipEntry';\nimport { ChipButton } from '../Chip/ChipButton';\n\nimport { SFXID } from '../AudioSystem/SFXEnums';\n\nconst { ccclass, property } = _decorator;\n\nconst MAX_STACK_COUNT = 5;\nconst MAX_STACK_PER_TYPE = 4;\n\n@ccclass('UIManager')\nexport class UIManager extends Component {\n\n    @property(Prefab)\n    private cardPrefab: Prefab = null!;\n\n    @property(Label)\n    private resultLabel: Label = null!;\n\n    @property(Button)\n    private dealButton: Button = null!;\n\n    @property(Button)\n    private hitButton: Button = null!;\n\n    @property(Button)\n    private standButton: Button = null!;\n\n    @property(Button)\n    private doubleButton: Button = null!;\n\n    @property(Button)\n    private resetButton: Button = null!;\n\n    @property(Button)\n    private splitButton: Button = null!;\n\n    @property(Node)\n    private deckPosition: Node = null!;\n\n    @property(Node)\n    private playerCardContainers: Node[] = []!;\n\n    @property(Label)\n    private playerScoreLabels: Label[] = []!;\n\n    @property(Node)\n    private handIndicators: Node[] = []!;\n\n    @property(Label)\n    private dealerScoreLabel: Label = null!;\n\n    @property(Node)\n    private dealerCardContainer: Node = null!;\n\n    @property(Button)\n    private potResetButton: Button = null!;\n\n    @property(Node)\n    private bettingArea: Node = null!;\n\n    @property(Node)\n    private potArea: Node = null!;\n\n    @property(Prefab)\n    private chipButtonPrefab: Prefab = null!;\n\n    @property(Label)\n    private totalBet: Label = null!;\n\n    private chipButtons: ChipButton[] = [];\n    private chipStacks: Map<number, number> = new Map(); // key: chip value, value: count\n    private chipStackPositions: Map<number, Vec2> = new Map(); // value �� position\n\n    private playerAnimationInProgress: number = 0;\n    private dealerAnimationInProgress: number = 0;\n\n    private playerHandCount = 0;\n\n    start() {\n        EventManager.instance.gameEvents.on(GameEvent.CHIP_ENTRY_READY, this.setupChipButtons, this);\n        EventManager.instance.gameEvents.on(GameEvent.ADD_CHIP_UI, this.addChip, this);\n        EventManager.instance.gameEvents.on(GameEvent.UPDATE_BET_VALUE, this.updateBetValue, this);\n        EventManager.instance.gameEvents.on(GameEvent.GAME_STARTED, this.onGameStarted, this);\n        EventManager.instance.gameEvents.on(GameEvent.DEAL_CARD, this.addCardToParticipant, this);\n        EventManager.instance.gameEvents.on(GameEvent.SPLIT_HAND, this.animateSplitHand, this);\n        EventManager.instance.gameEvents.on(GameEvent.CHANGE_HAND, this.changeHand, this);\n        EventManager.instance.gameEvents.on(GameEvent.GAME_ENDED, this.displayResult, this);\n        EventManager.instance.gameEvents.on(GameEvent.GAME_RESET, this.resetUI, this);\n        EventManager.instance.gameEvents.on(GameEvent.DEALER_TURN_END, this.flipDealerCards, this);\n        EventManager.instance.gameEvents.on(GameEvent.LOCK_INPUT, this.lockInput, this);\n        EventManager.instance.gameEvents.on(GameEvent.UNLOCK_INPUT, this.unlockInput, this);\n\n        this.attachPlaySFXToButton(this.node.parent);\n        this.resetUI();\n    }\n\n    private resetUI() {\n        console.log('Resetting UI...');\n        this.dealButton.interactable = false;\n        this.dealButton.node.active = true;\n        this.hitButton.node.active = false;\n        this.standButton.node.active = false;\n        this.doubleButton.node.active = false;\n        this.resultLabel.node.active = false;\n        this.resetButton.node.active = false;\n        this.splitButton.node.active = false;\n        this.playerScoreLabels.forEach(playerScoreLabel => {\n            playerScoreLabel.node.active = false;\n        });\n        this.dealerScoreLabel.node.active = false;\n\n        this.playerCardContainers.forEach(playerCardContainer => {\n            playerCardContainer.removeAllChildren();   \n        });\n        this.dealerCardContainer.removeAllChildren();\n\n        this.chipButtons.forEach(chipButton => {\n            chipButton.setInteractable(true);\n        });\n\n        this.handIndicators.forEach(handIndicator => {\n            handIndicator.active = false;\n        });\n        this.potArea.removeAllChildren();\n        this.resetPot();\n        this.playerHandCount = 0;\n    }\n\n    protected onDestroy(): void {\n        EventManager.instance.gameEvents.off(GameEvent.CHIP_ENTRY_READY, this.setupChipButtons, this);\n        EventManager.instance.gameEvents.off(GameEvent.ADD_CHIP_UI, this.addChip, this);\n        EventManager.instance.gameEvents.off(GameEvent.UPDATE_BET_VALUE, this.updateBetValue, this);\n        EventManager.instance.gameEvents.off(GameEvent.GAME_STARTED, this.onGameStarted, this);\n        EventManager.instance.gameEvents.off(GameEvent.DEAL_CARD, this.addCardToParticipant, this);\n        EventManager.instance.gameEvents.off(GameEvent.GAME_ENDED, this.displayResult, this);\n        EventManager.instance.gameEvents.off(GameEvent.GAME_RESET, this.resetUI, this);\n        EventManager.instance.gameEvents.off(GameEvent.DEALER_TURN_END, this.flipDealerCards, this);\n    }\n\n    private setupChipButtons(chipEntries: ChipEntry[]) {        \n        for (let i = 0; i < chipEntries.length; i++) {\n            const entry = chipEntries[i];\n            const chipNode = instantiate(this.chipButtonPrefab);\n            chipNode.setParent(this.bettingArea);\n            \n            const chipButton = chipNode.getComponent(ChipButton);\n            this.chipButtons.push(chipButton);\n            chipButton.setup(entry);\n            chipNode.setPosition(0, 0);\n        }\n    }\n\n    private addChip(chipEntry: ChipEntry) {\n        const baseX = 0;\n        const baseY = 0;    \n        const offsetX = 60;\n        const offsetY = 10;\n\n        // Get current stack count and position\n        let stackPositionY = 0;\n        if (!this.chipStackPositions.has(chipEntry.value)) {\n            this.chipStacks.set(chipEntry.value, 0);\n            this.chipStackPositions.set(chipEntry.value, new Vec2(this.chipStackPositions.size, 0));\n        }\n        \n        let stackCount = this.chipStacks.get(chipEntry.value);\n        let stackPositionX = this.chipStackPositions.get(chipEntry.value).x;\n        stackPositionY = this.chipStackPositions.get(chipEntry.value).y + 1;\n        if (stackCount >= MAX_STACK_PER_TYPE * MAX_STACK_COUNT) {\n            console.log('Too many chips for one type, stop displaying new chip');\n            return;\n        }\n        if (stackCount % MAX_STACK_COUNT == 0) {\n            stackPositionY = stackPositionY - MAX_STACK_COUNT - 4;\n        }\n            \n        const chipNode = instantiate(this.chipButtonPrefab);\n        chipNode.setParent(this.potArea);\n        const chipButton = chipNode.getComponent(ChipButton);\n        chipButton.setup(chipEntry);\n        chipButton.setInteractable(false);\n        \n        chipNode.setPosition(baseX + stackPositionX * offsetX, baseY + stackPositionY * offsetY);\n        this.chipStacks.set(chipEntry.value, stackCount + 1);\n        this.chipStackPositions.set(chipEntry.value, new Vec2(stackPositionX, stackPositionY));\n\n        this.potResetButton.interactable = true;\n    }\n\n    private updateBetValue(betValue: number) {\n        this.totalBet.string = \"Bet: $\" + betValue;\n        if (betValue > 0) {\n            this.dealButton.interactable = true;\n        } else {\n            this.dealButton.interactable = false;\n            this.resetPot();\n        }\n    }\n\n    private resetPot() {\n        this.potArea.removeAllChildren();\n        this.chipStacks.clear();\n        this.chipStackPositions.clear();\n        this.potResetButton.interactable = false;\n\n        EventManager.instance.gameEvents.emit(GameEvent.PLAY_SFX, SFXID.Chip, this);\n    }\n\n    private onGameStarted(player: Player) {\n        this.dealButton.node.active = false;\n        this.hitButton.node.active = true;\n        this.standButton.node.active = true;\n        this.doubleButton.node.active = true;\n        this.chipButtons.forEach(chipButton => {\n            chipButton.setInteractable(false);\n        });\n        this.splitButton.node.active = true;\n        if (player.canSplit()) {\n            this.splitButton.interactable = true;\n        } else {\n            this.splitButton.interactable = false;\n        }\n        this.playerHandCount++;\n    }\n\n    async addCardToParticipant(participant: Participant) {\n        this.potResetButton.interactable = false;\n\n        let handArea = null;\n        if (participant instanceof Player) {\n            const handIndex = participant.getIndex();\n            handArea = this.playerCardContainers[handIndex];\n        } else if (participant instanceof Dealer) {\n            handArea = this.dealerCardContainer;\n        }\n        \n        const hand = participant.getHand();\n        for (let i = handArea.children.length; i < hand.length; i++) {\n            await this.animateCardToHand(participant, handArea);\n        }\n        EventManager.instance.gameEvents.emit(GameEvent.ANIMATION_FINISHED, participant);\n    }\n\n    async animateCardToHand(participant: Participant, handArea: Node): Promise<void> {\n        EventManager.instance.gameEvents.emit(GameEvent.PLAY_SFX, SFXID.CardDeal);\n\n        const hand = participant.getHand();\n        const displayedCardCount = handArea.children.length;\n        if (displayedCardCount >= hand.length) {\n            return;\n        }\n        const latestCardData = hand[displayedCardCount];\n\n        // Get or create visual card node\n        const cardNode = instantiate(this.cardPrefab);\n        let card = cardNode.addComponent(Card);\n        card.init(latestCardData);\n        \n        // Add to scene\n        let scoreLabel;\n        if (participant instanceof Player) {\n            latestCardData.isFaceDown = false;\n            this.playerAnimationInProgress++;\n            const handIndex = participant.getIndex();\n            scoreLabel = this.playerScoreLabels[handIndex];\n        } else if (participant instanceof Dealer) {\n            latestCardData.isFaceDown = (displayedCardCount === 0 && !participant.revealAll);\n            this.dealerAnimationInProgress++;\n            scoreLabel = this.dealerScoreLabel;\n        }\n        handArea.addChild(cardNode);\n        \n        // Position at deck first\n        cardNode.setWorldPosition(this.deckPosition.getWorldPosition());\n        \n        // Animate to hand position\n        const targetPos = this.getCardTargetPosition(displayedCardCount);\n        await new Promise<void>((resolve) => {\n            tween(cardNode)\n            .to(0.5, { position: targetPos })\n            .call(async () => {\n                if (!latestCardData.isFaceDown) {\n                    if (participant instanceof Player) {\n                        console.log('Animating for Player');\n                    }\n                    await card.flipCard();\n                    if (participant instanceof Player) {\n                        console.log('Done animating for Player');\n                    }\n                    this.checkRemainingAnimation(participant);\n                    scoreLabel.string = 'Hand Value: ' + participant.getHandValue();\n                }\n            })\n            .call(resolve)\n            .start();\n        });\n    }\n    \n    async flipDealerCards() {\n        const dealerCardNodes = this.dealerCardContainer.children;\n        for (let i = 0; i < dealerCardNodes.length; i++) {\n            const cardNode = dealerCardNodes[0];\n            const card = cardNode.getComponent(Card);\n            if (card.isFaceDown) {\n                await card.flipCard();\n                this.checkRemainingAnimation(new Dealer);\n            }\n        }\n    }\n\n    async animateSplitHand() {\n        EventManager.instance.gameEvents.emit(GameEvent.PLAY_SFX, SFXID.CardDeal);\n        const originHandArea = this.playerCardContainers[0];\n        const targetHandArea = this.playerCardContainers[1];\n\n        const targetCard = originHandArea.children[1];\n        const worldPos = targetCard.worldPosition.clone();\n        targetCard.removeFromParent();\n        targetHandArea.addChild(targetCard);\n        targetCard.setWorldPosition(worldPos);\n\n        const targetPos = this.getCardTargetPosition(0);\n            await new Promise<void>((resolve) => {\n                tween(targetCard)\n                .to(0.5, { position: targetPos })\n                .call(resolve)\n                .start();\n        });\n        this.splitButton.interactable = false;\n        this.handIndicators[0].active = true;\n        this.playerHandCount++;\n    }\n\n    private changeHand(handIndex: number) {\n        if (this.playerHandCount == 1) return;\n        this.handIndicators.forEach(handIndicator => {\n            handIndicator.active = false;\n        });\n        this.handIndicators[handIndex].active = true;\n    }\n    \n    private checkRemainingAnimation(participant: Participant) {\n        if (participant instanceof Player) {\n            this.playerAnimationInProgress--;\n        } else if (participant instanceof Dealer) {\n            this.dealerAnimationInProgress--;\n        }\n        console.log('Player animations left:', this.playerAnimationInProgress, 'Dealer animations left:', this.dealerAnimationInProgress);\n        if ((this.playerAnimationInProgress <= 0 && participant instanceof Player) ||\n            (this.dealerAnimationInProgress <= 0 && participant instanceof Dealer)) {\n            console.log('All animations finished.');\n            EventManager.instance.gameEvents.emit(GameEvent.ANIMATION_FINISHED, participant);\n        }\n    }\n\n    private getCardTargetPosition(cardIndex: number): Vec3 {\n        const xOffset = 50;\n        const yOffset = -40;\n        const x = (cardIndex % 13) * xOffset;\n        const y = Math.floor(cardIndex / 13) * yOffset;\n        return new Vec3(x, y, 0);\n    }\n\n    private displayResult(result: string) {\n        // Implement result display logic (e.g., show a popup or update a label)\n        console.log('Game Result:', result);\n        this.resultLabel.node.active = true;\n        this.resultLabel.string = result;\n        this.hitButton.node.active = false;\n        this.standButton.node.active = false;\n        this.resetButton.node.active = true;\n        this.doubleButton.node.active = false;\n        this.splitButton.node.active = false;\n\n        for (let i = 0; i < this.playerHandCount; i++) {\n            this.playerScoreLabels[i].node.active = true;\n        }\n        \n        this.handIndicators.forEach(handIndicator => {\n            handIndicator.active = false;\n        });\n        this.dealerScoreLabel.node.active = true;\n    }\n\n    private attachPlaySFXToButton(root: Node) {\n        const buttons = root.getComponentsInChildren(Button);\n        for (const button of buttons) {\n            button.node.on(Button.EventType.CLICK, this.playButtonSFX, this);\n        }\n    }\n\n    private playButtonSFX() {\n        EventManager.instance.gameEvents.emit(GameEvent.PLAY_SFX, SFXID.ButtonClick);\n    }\n\n    private lockInput() {\n        this.dealButton.interactable = false;\n        this.hitButton.interactable = false;\n        this.standButton.interactable = false;\n        this.doubleButton.interactable = false;\n        this.resetButton.interactable = false;\n        this.splitButton.interactable = false;\n    }\n\n    private unlockInput() {\n        this.dealButton.interactable = true;\n        this.hitButton.interactable = true;\n        this.standButton.interactable = true;\n        this.doubleButton.interactable = true;\n        this.resetButton.interactable = true;\n    }\n}\n\n"]}