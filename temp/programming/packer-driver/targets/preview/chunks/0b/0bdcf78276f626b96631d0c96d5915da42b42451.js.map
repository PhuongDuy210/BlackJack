{"version":3,"sources":["file:///Users/phuongduy/CardDeck/assets/scripts/Popup/GenericPopup.ts"],"names":["_decorator","Component","Node","Label","Prefab","instantiate","Vec3","tween","Enum","view","PopupAnimationType","ccclass","property","GenericPopup","type","screenSize","getVisibleSize","popupPanel","isShown","start","node","animateEntry","show","title","message","buttons","entryAnimation","exitAnimation","titleText","string","messageText","entryAnimationType","exitAnimationType","buttonContainer","removeAllChildren","btnData","prefab","buttonPrefabOverride","defaultButtonPrefab","btnNode","addChild","label","getComponentInChildren","on","EventType","TOUCH_END","callback","close","active","animateExit","shown","onComplete","FlyBottom","setPosition","height","to","animationDuration","position","onscreenTarget","call","FlyTop","FlyLeft","width","FlyRight","Scale","setScale","scale"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, Label, Prefab, instantiate, Vec3, tween, Enum , view } from 'cc';\nconst { ccclass, property } = _decorator;\n\nimport { PopupButtonData } from './PopupButtonData';\nimport { PopupAnimationType } from '../enums/PopupAnimationType';\n\n@ccclass('GenericPopup')\nexport class GenericPopup extends Component {\n    private screenSize = view.getVisibleSize();\n\n    private popupPanel: Node;\n\n    @property\n    animationDuration: number = 0.75;\n\n    @property({ type: Enum(PopupAnimationType) })\n    entryAnimationType: PopupAnimationType = PopupAnimationType.FlyTop;\n\n    @property({ type: Enum(PopupAnimationType) })\n    exitAnimationType: PopupAnimationType = PopupAnimationType.FlyTop;\n\n    @property(Vec3)\n    onscreenTarget: Vec3 = new Vec3(0, 0, 0);\n\n    @property(Label)\n    titleText: Label = null!;\n\n    @property(Label)\n    messageText: Label = null!;\n\n    @property(Node)\n    buttonContainer: Node = null!;\n\n    @property(Prefab)\n    defaultButtonPrefab: Prefab = null!;\n\n    private isShown = false;\n\n    protected start(): void {\n        this.popupPanel = this.node;\n        this.animateEntry();\n    }\n\n    public show(title: string, message: string, buttons: PopupButtonData[], entryAnimation?: PopupAnimationType | null, exitAnimation?: PopupAnimationType | null) {\n        this.titleText.string = title;\n        this.messageText.string = message;\n        this.entryAnimationType = entryAnimation ? entryAnimation : this.entryAnimationType;\n        this.exitAnimationType = exitAnimation ? exitAnimation : this.exitAnimationType;\n\n        this.buttonContainer.removeAllChildren();\n\n        for (const btnData of buttons) {\n            const prefab = btnData.buttonPrefabOverride || this.defaultButtonPrefab;\n            const btnNode = instantiate(prefab);\n            this.buttonContainer.addChild(btnNode);\n\n            const label = btnNode.getComponentInChildren(Label);\n            if (label) label.string = btnData.label;\n\n            btnNode.on(Node.EventType.TOUCH_END, () => {\n                btnData.callback?.();\n                this.close();\n            });\n        }\n\n        this.node.active = true;\n        this.animateEntry();\n        this.isShown = true;\n    }\n\n    public close() {\n        this.animateExit(() => {\n            this.node.active = false;\n        });\n        this.isShown = false;\n    }\n\n    public shown(): boolean {\n        return this.isShown;\n    }\n\n    private animateEntry(onComplete?: () => void) {\n        switch(this.entryAnimationType) {\n            case PopupAnimationType.FlyBottom:\n                this.popupPanel.setPosition(new Vec3(0, -this.screenSize.height, 0));\n                tween(this.popupPanel)\n                    .to(this.animationDuration, { position: this.onscreenTarget })\n                    .call(() => onComplete?.())\n                    .start();\n                \n                break;\n                \n            case PopupAnimationType.FlyTop:\n                this.popupPanel.setPosition(new Vec3(0, this.screenSize.height, 0));\n                tween(this.popupPanel)\n                    .to(this.animationDuration, { position: this.onscreenTarget })\n                    .call(() => onComplete?.())\n                    .start();\n                \n                break;\n                    \n            case PopupAnimationType.FlyLeft:\n                this.popupPanel.setPosition(new Vec3(-this.screenSize.width, 0, 0));\n                tween(this.popupPanel)\n                    .to(this.animationDuration, { position: this.onscreenTarget })\n                    .call(() => onComplete?.())\n                    .start();\n\n                break;\n                        \n            case PopupAnimationType.FlyRight:\n                this.popupPanel.setPosition(new Vec3(this.screenSize.width, 0, 0));\n                tween(this.popupPanel)\n                    .to(this.animationDuration, { position: this.onscreenTarget })\n                    .call(() => onComplete?.())\n                    .start();\n\n                break;\n                            \n            case PopupAnimationType.Scale:\n                this.popupPanel.setScale(new Vec3(0, 0, 1));\n                tween(this.popupPanel)\n                    .to(this.animationDuration, { scale: new Vec3(1, 1, 1) })\n                    .call(() => onComplete?.())\n                    .start();\n                    \n                break;\n        }\n    }\n\n    private animateExit(onComplete?: () => void) {\n        switch(this.exitAnimationType) {\n            case PopupAnimationType.FlyBottom:\n                this.popupPanel.setPosition(this.onscreenTarget);\n                tween(this.popupPanel)\n                    .to(this.animationDuration, { position: new Vec3(0, -this.screenSize.height, 0) })\n                    .call(() => onComplete?.())\n                    .start();\n\n                break;\n\n            case PopupAnimationType.FlyTop:\n                this.popupPanel.setPosition(this.onscreenTarget);\n                tween(this.popupPanel)\n                    .to(this.animationDuration, { position: new Vec3(0, this.screenSize.height, 0) })\n                    .call(() => onComplete?.())\n                    .start();\n\n                break;\n\n            case PopupAnimationType.FlyLeft:\n                this.popupPanel.setPosition(this.onscreenTarget);\n                tween(this.popupPanel)\n                    .to(this.animationDuration, { position: new Vec3(-this.screenSize.width, 0, 0) })\n                    .call(() => onComplete?.())\n                    .start();\n\n                break;\n\n            case PopupAnimationType.FlyRight:\n                this.popupPanel.setPosition(this.onscreenTarget);\n                tween(this.popupPanel)\n                    .to(this.animationDuration, { position: new Vec3(this.screenSize.width, 0, 0) })\n                    .call(() => onComplete?.())\n                    .start();\n\n                break;\n\n            case PopupAnimationType.Scale:\n                this.popupPanel.setScale(new Vec3(1, 1, 1));\n                tween(this.popupPanel)\n                    .to(this.animationDuration, { scale: new Vec3(0, 0, 1) })\n                    .call(() => onComplete?.())\n                    .start();\n\n                break;\n        }\n    }\n}"]}