{"version":3,"sources":["file:///Users/phuongduy/CardDeck/assets/scripts/Managers/GameManager.ts"],"names":["_decorator","Component","DeckManager","EventManager","GameEvent","Player","Dealer","ccclass","property","GameManager","player","dealer","start","instance","gameEvents","on","DECK_LOADED","onDeckLoaded","onDestroy","off","deck","console","log","initialDeal","i","playerCardData","deckManager","dealCard","dealerCardData","addCard","getHand","emit","GAME_STARTED","CARD_DEALED","playerHit","cardData","playerStand","dealerPlay","shouldHit","revealAll"],"mappings":"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","sourcesContent":["import { _decorator, Component } from 'cc';\nconst { ccclass, property } = _decorator;\nimport { Deck } from '../Deck';\nimport { DeckManager } from './DeckManager';\nimport { EventManager } from './EventManager';\nimport { GameEvent } from '../enums/GameEvent';\nimport { Player } from '../Player';\nimport { Dealer } from '../Dealer';\n\n@ccclass('GameManager')\nexport class GameManager extends Component {\n\n    @property(DeckManager)\n    private deckManager: DeckManager = null!;\n\n    private player = new Player('Player 1');\n    private dealer = new Dealer();\n\n    start() {\n        EventManager.instance.gameEvents.on(GameEvent.DECK_LOADED, this.onDeckLoaded, this);\n    }\n\n    protected onDestroy(): void {\n        EventManager.instance.gameEvents.off(GameEvent.DECK_LOADED, this.onDeckLoaded, this);\n    }\n\n    private onDeckLoaded(deck: Deck) {\n        // Start the game logic here, e.g., deal initial cards\n        console.log('Game started with deck:', deck);\n    }\n\n    public initialDeal() {\n        for (let i = 0; i < 2; i++) {\n            const playerCardData = this.deckManager.dealCard();\n            const dealerCardData = this.deckManager.dealCard();\n\n            if (playerCardData) {\n                this.player.addCard(playerCardData);\n            }\n            if (dealerCardData) {\n                this.dealer.addCard(dealerCardData);\n            }\n        }\n\n        console.log('Player Hand:', this.player.getHand());\n        console.log('Dealer Hand:', this.dealer.getHand());\n\n        EventManager.instance.gameEvents.emit(GameEvent.GAME_STARTED);\n        EventManager.instance.gameEvents.emit(GameEvent.CARD_DEALED, this.player);\n        EventManager.instance.gameEvents.emit(GameEvent.CARD_DEALED, this.dealer);\n    }\n\n    public playerHit() {\n        const cardData = this.deckManager.dealCard();\n        if (cardData) {\n            this.player.addCard(cardData);\n            EventManager.instance.gameEvents.emit(GameEvent.CARD_DEALED, this.player);\n        }\n    }\n\n    public playerStand() {\n        console.log('Player stands with hand:', this.player.getHand());\n        this.dealerPlay();\n    }\n\n    public dealerPlay() {\n        while (this.dealer.shouldHit()) {\n            const cardData = this.deckManager.dealCard();\n            if (cardData) {\n                this.dealer.addCard(cardData);\n                console.log('Dealer hits and receives:', cardData);\n                EventManager.instance.gameEvents.emit(GameEvent.CARD_DEALED, this.dealer);\n            }\n        }\n        console.log('Dealer Hand now:', this.dealer.getHand());\n        this.dealer.revealAll = true;\n        EventManager.instance.gameEvents.emit(GameEvent.CARD_DEALED, this.dealer);\n    }\n}"]}