{"version":3,"sources":["file:///Users/phuongduy/CardDeck/assets/scripts/Managers/UIManager.ts"],"names":["_decorator","Button","Component","Node","Prefab","instantiate","SpriteFrame","EventManager","GameEvent","Card","Player","Dealer","ccclass","property","UIManager","start","dealButton","interactable","hitButton","node","active","standButton","instance","gameEvents","on","DECK_LOADED","onDeckLoaded","GAME_STARTED","onGameStarted","CARD_DEALED","updateCardDisplay","onDestroy","off","hand","cardDataList","getHand","playerCardContainer","removeAllChildren","i","length","cardData","cardNode","cardPrefab","setPosition","Math","floor","addChild","card","addComponent","init","dealerCardContainer","isFaceDown","revealAll","console","log","spriteFrame","cardBackSprite"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,W,OAAAA,W;;AAC1DC,MAAAA,Y,iBAAAA,Y;;AACAC,MAAAA,S,iBAAAA,S;;AACAC,MAAAA,I,iBAAAA,I;;AAIAC,MAAAA,M,iBAAAA,M;;AACAC,MAAAA,M,iBAAAA,M;;;;;;;;;OAEH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBb,U;;2BAGjBc,S,WADZF,OAAO,CAAC,WAAD,C,UAEHC,QAAQ,CAACT,MAAD,C,UAGRS,QAAQ,CAACP,WAAD,C,UAGRO,QAAQ,CAACZ,MAAD,C,UAGRY,QAAQ,CAACZ,MAAD,C,UAGRY,QAAQ,CAACZ,MAAD,C,UAGRY,QAAQ,CAACV,IAAD,C,UAGRU,QAAQ,CAACV,IAAD,C,2BApBb,MACaW,SADb,SAC+BZ,SAD/B,CACyC;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;AAAA;;AAuBrCa,QAAAA,KAAK,GAAG;AACJ,eAAKC,UAAL,CAAgBC,YAAhB,GAA+B,KAA/B;AACA,eAAKC,SAAL,CAAeC,IAAf,CAAoBC,MAApB,GAA6B,KAA7B;AACA,eAAKC,WAAL,CAAiBF,IAAjB,CAAsBC,MAAtB,GAA+B,KAA/B;AAEA;AAAA;AAAA,4CAAaE,QAAb,CAAsBC,UAAtB,CAAiCC,EAAjC,CAAoC;AAAA;AAAA,sCAAUC,WAA9C,EAA2D,KAAKC,YAAhE,EAA8E,IAA9E;AACA;AAAA;AAAA,4CAAaJ,QAAb,CAAsBC,UAAtB,CAAiCC,EAAjC,CAAoC;AAAA;AAAA,sCAAUG,YAA9C,EAA4D,KAAKC,aAAjE,EAAgF,IAAhF;AACA;AAAA;AAAA,4CAAaN,QAAb,CAAsBC,UAAtB,CAAiCC,EAAjC,CAAoC;AAAA;AAAA,sCAAUK,WAA9C,EAA2D,KAAKC,iBAAhE,EAAmF,IAAnF;AACH;;AAESC,QAAAA,SAAS,GAAS;AACxB;AAAA;AAAA,4CAAaT,QAAb,CAAsBC,UAAtB,CAAiCS,GAAjC,CAAqC;AAAA;AAAA,sCAAUP,WAA/C,EAA4D,KAAKC,YAAjE,EAA+E,IAA/E;AACA;AAAA;AAAA,4CAAaJ,QAAb,CAAsBC,UAAtB,CAAiCS,GAAjC,CAAqC;AAAA;AAAA,sCAAUL,YAA/C,EAA6D,KAAKC,aAAlE,EAAiF,IAAjF;AACA;AAAA;AAAA,4CAAaN,QAAb,CAAsBC,UAAtB,CAAiCS,GAAjC,CAAqC;AAAA;AAAA,sCAAUH,WAA/C,EAA4D,KAAKC,iBAAjE,EAAoF,IAApF;AACH;;AAEOJ,QAAAA,YAAY,GAAG;AACnB,eAAKV,UAAL,CAAgBC,YAAhB,GAA+B,IAA/B;AACH;;AAEOW,QAAAA,aAAa,GAAG;AACpB,eAAKZ,UAAL,CAAgBG,IAAhB,CAAqBC,MAArB,GAA8B,KAA9B;AACA,eAAKF,SAAL,CAAeC,IAAf,CAAoBC,MAApB,GAA6B,IAA7B;AACA,eAAKC,WAAL,CAAiBF,IAAjB,CAAsBC,MAAtB,GAA+B,IAA/B;AACH;;AAEMU,QAAAA,iBAAiB,CAACG,IAAD,EAAoB;AACxC,cAAIA,IAAI;AAAA;AAAA,+BAAR,EAA4B;AACxB;AACA,kBAAMC,YAAY,GAAGD,IAAI,CAACE,OAAL,EAArB;AACA,iBAAKC,mBAAL,CAAyBC,iBAAzB;;AACA,iBAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGJ,YAAY,CAACK,MAAjC,EAAyCD,CAAC,EAA1C,EAA8C;AAC1C,oBAAME,QAAQ,GAAG,EAAE,GAAGN,YAAY,CAACI,CAAD;AAAjB,eAAjB,CAD0C,CACD;;AACzC,oBAAMG,QAAQ,GAAGpC,WAAW,CAAC,KAAKqC,UAAN,CAA5B;AACAD,cAAAA,QAAQ,CAACE,WAAT,CAAsBL,CAAC,GAAG,EAAL,GAAW,EAAhC,EAAoCM,IAAI,CAACC,KAAL,CAAWP,CAAC,GAAG,EAAf,IAAqB,CAAC,EAA1D,EAA8D,CAA9D;AACA,mBAAKF,mBAAL,CAAyBU,QAAzB,CAAkCL,QAAlC;AACA,kBAAIM,IAAI,GAAGN,QAAQ,CAACO,YAAT;AAAA;AAAA,+BAAX;AACAD,cAAAA,IAAI,CAACE,IAAL,CAAUT,QAAV;AACH;AACJ,WAZD,MAYO,IAAIP,IAAI;AAAA;AAAA,+BAAR,EAA4B;AAC/B;AACA,kBAAMC,YAAY,GAAGD,IAAI,CAACE,OAAL,EAArB;AACA,iBAAKe,mBAAL,CAAyBb,iBAAzB;;AACA,iBAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGJ,YAAY,CAACK,MAAjC,EAAyCD,CAAC,EAA1C,EAA8C;AAC1C,oBAAME,QAAQ,GAAG,EAAE,GAAGN,YAAY,CAACI,CAAD;AAAjB,eAAjB,CAD0C,CACD;;AACzC,oBAAMa,UAAU,GAAIb,CAAC,KAAK,CAAN,IAAW,CAACL,IAAI,CAACmB,SAArC,CAF0C,CAEO;;AACjDC,cAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ,EAAoBhB,CAApB,EAAuB,eAAvB,EAAwCa,UAAxC;;AACA,kBAAIA,UAAJ,EAAgB;AACZX,gBAAAA,QAAQ,CAACe,WAAT,GAAuB,KAAKC,cAA5B;AACH;;AACD,oBAAMf,QAAQ,GAAGpC,WAAW,CAAC,KAAKqC,UAAN,CAA5B;AACAD,cAAAA,QAAQ,CAACE,WAAT,CAAsBL,CAAC,GAAG,EAAL,GAAW,EAAhC,EAAoCM,IAAI,CAACC,KAAL,CAAWP,CAAC,GAAG,EAAf,IAAqB,CAAC,EAA1D,EAA8D,CAA9D;AACA,mBAAKY,mBAAL,CAAyBJ,QAAzB,CAAkCL,QAAlC;AACA,kBAAIM,IAAI,GAAGN,QAAQ,CAACO,YAAT;AAAA;AAAA,+BAAX;AACAD,cAAAA,IAAI,CAACE,IAAL,CAAUT,QAAV;AACH;AACJ;AACJ;;AAhFoC,O;;;;;iBAER,I;;;;;;;iBAGS,I;;;;;;;iBAGT,I;;;;;;;iBAGD,I;;;;;;;iBAGE,I;;;;;;;iBAGM,I;;;;;;;iBAGA,I","sourcesContent":["import { _decorator, Button, Component, Node, Prefab, instantiate, SpriteFrame } from 'cc';\nimport { EventManager } from './EventManager';\nimport { GameEvent } from '../enums/GameEvent';\nimport { Card } from '../Card';\nimport { CardData } from '../CardData';\n\nimport { Participant } from '../Participant';\nimport { Player } from '../Player';\nimport { Dealer } from '../Dealer';\n\nconst { ccclass, property } = _decorator;\n\n@ccclass('UIManager')\nexport class UIManager extends Component {\n    @property(Prefab)\n    private cardPrefab: Prefab = null!;\n\n    @property(SpriteFrame)\n    private cardBackSprite: SpriteFrame = null!;\n    \n    @property(Button)\n    private dealButton: Button = null!;\n\n    @property(Button)\n    private hitButton: Button = null!;\n\n    @property(Button)\n    private standButton: Button = null!;\n\n    @property(Node)\n    private playerCardContainer: Node = null!;\n\n    @property(Node)\n    private dealerCardContainer: Node = null!;\n\n\n    start() {\n        this.dealButton.interactable = false;\n        this.hitButton.node.active = false;\n        this.standButton.node.active = false;\n\n        EventManager.instance.gameEvents.on(GameEvent.DECK_LOADED, this.onDeckLoaded, this);\n        EventManager.instance.gameEvents.on(GameEvent.GAME_STARTED, this.onGameStarted, this);\n        EventManager.instance.gameEvents.on(GameEvent.CARD_DEALED, this.updateCardDisplay, this);\n    }\n\n    protected onDestroy(): void {\n        EventManager.instance.gameEvents.off(GameEvent.DECK_LOADED, this.onDeckLoaded, this);\n        EventManager.instance.gameEvents.off(GameEvent.GAME_STARTED, this.onGameStarted, this);\n        EventManager.instance.gameEvents.off(GameEvent.CARD_DEALED, this.updateCardDisplay, this);\n    }\n\n    private onDeckLoaded() {\n        this.dealButton.interactable = true;\n    }\n\n    private onGameStarted() {\n        this.dealButton.node.active = false;\n        this.hitButton.node.active = true;\n        this.standButton.node.active = true;\n    }\n\n    public updateCardDisplay(hand: Participant) {\n        if (hand instanceof Player) {\n            // Update player card display\n            const cardDataList = hand.getHand();\n            this.playerCardContainer.removeAllChildren();\n            for (let i = 0; i < cardDataList.length; i++) {\n                const cardData = { ...cardDataList[i] }; // Clone to avoid mutating original\n                const cardNode = instantiate(this.cardPrefab);\n                cardNode.setPosition((i % 13) * 30, Math.floor(i / 13) * -40, 0);\n                this.playerCardContainer.addChild(cardNode);\n                let card = cardNode.addComponent(Card);\n                card.init(cardData);\n            }\n        } else if (hand instanceof Dealer) {\n            // Update dealer card display\n            const cardDataList = hand.getHand();\n            this.dealerCardContainer.removeAllChildren();\n            for (let i = 0; i < cardDataList.length; i++) {\n                const cardData = { ...cardDataList[i] }; // Clone to avoid mutating original\n                const isFaceDown = (i === 0 && !hand.revealAll); // First card face down if not revealed\n                console.log('Card', i, ' isFaceDown =', isFaceDown);\n                if (isFaceDown) {\n                    cardData.spriteFrame = this.cardBackSprite;\n                }\n                const cardNode = instantiate(this.cardPrefab);\n                cardNode.setPosition((i % 13) * 30, Math.floor(i / 13) * -40, 0);\n                this.dealerCardContainer.addChild(cardNode);\n                let card = cardNode.addComponent(Card);\n                card.init(cardData);\n            }\n        }   \n    }\n}\n\n"]}