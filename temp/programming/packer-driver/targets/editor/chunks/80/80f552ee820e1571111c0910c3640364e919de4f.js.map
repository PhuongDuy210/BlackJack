{"version":3,"sources":["file:///Users/phuongduy/CardDeck/assets/scripts/Managers/UIManager.ts"],"names":["_decorator","Button","Component","Node","Prefab","instantiate","SpriteFrame","Label","EventManager","GameEvent","Card","Player","Dealer","ccclass","property","UIManager","start","instance","gameEvents","on","DECK_LOADED","onDeckLoaded","GAME_STARTED","onGameStarted","CARD_DEALED","updateCardDisplay","GAME_ENDED","displayResult","GAME_RESET","resetUI","console","log","dealButton","interactable","node","active","hitButton","standButton","doubleButton","resultLabel","resetButton","playerCardContainer","removeAllChildren","dealerCardContainer","onDestroy","off","hand","cardDataList","getHand","i","length","cardData","cardNode","cardPrefab","setPosition","Math","floor","addChild","card","addComponent","init","isFaceDown","revealAll","spriteFrame","cardBackSprite","result","string"],"mappings":"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","sourcesContent":["import { _decorator, Button, Component, Node, Prefab, instantiate, SpriteFrame, Label } from 'cc';\nimport { EventManager } from './EventManager';\nimport { GameEvent } from '../enums/GameEvent';\nimport { Card } from '../Card';\nimport { CardData } from '../CardData';\n\nimport { Participant } from '../Participant';\nimport { Player } from '../Player';\nimport { Dealer } from '../Dealer';\n\nconst { ccclass, property } = _decorator;\n\n@ccclass('UIManager')\nexport class UIManager extends Component {\n    @property(Prefab)\n    private cardPrefab: Prefab = null!;\n\n    @property(SpriteFrame)\n    private cardBackSprite: SpriteFrame = null!;\n\n    @property(Label)\n    private resultLabel: Label = null!;\n\n    @property(Button)\n    private dealButton: Button = null!;\n\n    @property(Button)\n    private hitButton: Button = null!;\n\n    @property(Button)\n    private standButton: Button = null!;\n\n    @property(Button)\n    private doubleButton: Button = null!;\n\n    @property(Button)\n    private resetButton: Button = null!;\n\n    @property(Node)\n    private playerCardContainer: Node = null!;\n\n    @property(Node)\n    private dealerCardContainer: Node = null!;\n\n\n    start() {\n        EventManager.instance.gameEvents.on(GameEvent.DECK_LOADED, this.onDeckLoaded, this);\n        EventManager.instance.gameEvents.on(GameEvent.GAME_STARTED, this.onGameStarted, this);\n        EventManager.instance.gameEvents.on(GameEvent.CARD_DEALED, this.updateCardDisplay, this);\n        EventManager.instance.gameEvents.on(GameEvent.GAME_ENDED, this.displayResult, this);\n        EventManager.instance.gameEvents.on(GameEvent.GAME_RESET, this.resetUI, this);\n\n        this.resetUI();\n    }\n\n    private resetUI() {\n        console.log('Resetting UI...');\n        this.dealButton.interactable = false;\n        this.dealButton.node.active = true;\n        this.hitButton.node.active = false;\n        this.standButton.node.active = false;\n        this.doubleButton.node.active = false;\n        this.resultLabel.node.active = false;\n        this.resetButton.node.active = false;\n\n        this.playerCardContainer.removeAllChildren();\n        this.dealerCardContainer.removeAllChildren();\n    }\n\n    protected onDestroy(): void {\n        EventManager.instance.gameEvents.off(GameEvent.DECK_LOADED, this.onDeckLoaded, this);\n        EventManager.instance.gameEvents.off(GameEvent.GAME_STARTED, this.onGameStarted, this);\n        EventManager.instance.gameEvents.off(GameEvent.CARD_DEALED, this.updateCardDisplay, this);\n        EventManager.instance.gameEvents.off(GameEvent.GAME_ENDED, this.displayResult, this);\n        EventManager.instance.gameEvents.off(GameEvent.GAME_RESET, this.resetUI, this);\n    }\n\n    private onDeckLoaded() {\n        this.dealButton.interactable = true;\n    }\n\n    private onGameStarted() {\n        this.dealButton.node.active = false;\n        this.hitButton.node.active = true;\n        this.standButton.node.active = true;\n        this.doubleButton.node.active = true;\n    }\n\n    public updateCardDisplay(hand: Participant) {\n        if (hand instanceof Player) {\n            // Update player card display\n            const cardDataList = hand.getHand();\n            this.playerCardContainer.removeAllChildren();\n            for (let i = 0; i < cardDataList.length; i++) {\n                const cardData = { ...cardDataList[i] }; // Clone to avoid mutating original\n                const cardNode = instantiate(this.cardPrefab);\n                cardNode.setPosition((i % 13) * 30, Math.floor(i / 13) * -40, 0);\n                this.playerCardContainer.addChild(cardNode);\n                let card = cardNode.addComponent(Card);\n                card.init(cardData);\n            }\n        } else if (hand instanceof Dealer) {\n            // Update dealer card display\n            const cardDataList = hand.getHand();\n            this.dealerCardContainer.removeAllChildren();\n            for (let i = 0; i < cardDataList.length; i++) {\n                const cardData = { ...cardDataList[i] }; // Clone to avoid mutating original\n                const isFaceDown = (i === 0 && !hand.revealAll); // First card face down if not revealed\n                console.log('Card', i, ' isFaceDown =', isFaceDown);\n                if (isFaceDown) {\n                    cardData.spriteFrame = this.cardBackSprite;\n                }\n                const cardNode = instantiate(this.cardPrefab);\n                cardNode.setPosition((i % 13) * 30, Math.floor(i / 13) * -40, 0);\n                this.dealerCardContainer.addChild(cardNode);\n                let card = cardNode.addComponent(Card);\n                card.init(cardData);\n            }\n        }   \n    }\n\n    private displayResult(result: string) {\n        // Implement result display logic (e.g., show a popup or update a label)\n        console.log('Game Result:', result);\n        this.resultLabel.node.active = true;\n        this.resultLabel.string = result;\n        this.hitButton.node.active = false;\n        this.standButton.node.active = false;\n        this.resetButton.node.active = true;\n        this.doubleButton.node.active = false;\n    }\n}\n\n"]}