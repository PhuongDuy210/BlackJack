{"version":3,"sources":["file:///Users/phuongduy/CardDeck/assets/scripts/Card.ts"],"names":["_decorator","Component","Sprite","tween","Vec3","CardAsset","EventManager","GameEvent","SFXID","ccclass","property","Card","cardSprite","rankLabel","suitLabel","suit","rank","values","isFaceDown","cardData","onLoad","node","getComponent","init","spriteFrame","backSpriteFrame","name","getValues","getName","flipCard","cardScale","scale","clone","console","log","instance","gameEvents","emit","PLAY_SFX","CardFlip","Promise","resolve","to","y","z","call","start"],"mappings":"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","sourcesContent":["import { _decorator, Component, Sprite, Label, SpriteFrame, tween, Vec3 } from 'cc';\nconst { ccclass, property } = _decorator;\nimport { CardData } from './CardData';\nimport { CardAsset } from './CardAsset';\n\nimport { EventManager } from './Managers/EventManager';\nimport { GameEvent } from './enums/GameEvent';\nimport { SFXID } from './AudioSystem/SFXEnums';\n\n@ccclass('Card')\nexport class Card extends Component {\n    cardSprite: Sprite = null;\n\n    rankLabel: Label = null;\n\n    suitLabel: Label = null;\n\n    // Optional: store card data for reference\n    private suit: string = '';\n    private rank: string = '';\n    private values: number[] = [];\n\n    public isFaceDown = true;\n\n    private cardData: CardData | null = null;\n\n    protected onLoad(): void {\n        this.cardSprite = this.node.getComponent(Sprite);\n    }\n\n    public init(cardData: CardData) {\n        this.suit = cardData.suit;\n        this.rank = cardData.rank;\n        this.values = cardData.values;\n\n        if (!this.cardSprite) {\n            this.cardSprite = this.node.getComponent(Sprite);\n        }\n        this.cardSprite.spriteFrame = CardAsset.backSpriteFrame;\n\n        this.node.name = `${cardData.rank}_of_${cardData.suit}`;\n        this.cardData = cardData;\n    }\n\n    public getValues(): number[] {\n        return this.values;\n    }\n\n    public getName(): string {\n        return `${this.rank} of ${this.suit}`;\n    }\n\n    public async flipCard() {\n        // Flip from front to back\n        const cardScale = this.node.scale.clone();\n        console.log('Flipping card:', this.getName(), 'Is face down:', this.cardData.isFaceDown);\n        EventManager.instance.gameEvents.emit(GameEvent.PLAY_SFX, SFXID.CardFlip, this);\n        await new Promise<void>((resolve) => {\n            tween(this.node)\n                .to(0.2, { scale: new Vec3(0, cardScale.y, cardScale.z) }) // Shrink to edge\n                .call(() => {\n                    // Swap sprite/frame here\n                    if (this.isFaceDown) {\n                        this.cardSprite.spriteFrame = this.cardData.spriteFrame;\n                    } else {\n                        this.cardSprite.spriteFrame = CardAsset.backSpriteFrame;\n                    }\n                })\n                .to(0.2, { scale: cardScale}) // Expand back out\n                .call(() => {\n                    this.isFaceDown = !this.isFaceDown;\n                    console.log('Card flipped:', this.getName(), 'Is face down now:', this.isFaceDown);\n                })\n                .call(resolve)\n                .start();\n        });\n        console.log('Finished flipping card');\n    }\n}"]}