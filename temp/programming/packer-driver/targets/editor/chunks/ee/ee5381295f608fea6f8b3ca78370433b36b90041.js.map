{"version":3,"sources":["file:///Users/phuongduy/CardDeck/assets/scripts/Popup/GenericPopup.ts"],"names":["_decorator","Component","Node","Label","Prefab","instantiate","Vec3","tween","Enum","view","PopupAnimationType","ccclass","property","GenericPopup","type","screenSize","getVisibleSize","popupPanel","isShown","start","node","show","title","message","buttons","titleText","string","messageText","buttonContainer","removeAllChildren","btnData","prefab","buttonPrefabOverride","defaultButtonPrefab","btnNode","addChild","label","getComponentInChildren","on","EventType","TOUCH_END","callback","close","active","animateEntry","animateExit","shown","onComplete","entryAnimationType","FlyBottom","setPosition","height","to","animationDuration","position","onscreenTarget","call","FlyTop","FlyLeft","width","FlyRight","Scale","setScale","scale","exitAnimationType"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,I,OAAAA,I;AAAOC,MAAAA,I,OAAAA,I;;AAI7EC,MAAAA,kB,iBAAAA,kB;;;;;;;;;OAHH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBZ,U;;8BAMjBa,Y,WADZF,OAAO,CAAC,cAAD,C,UASHC,QAAQ,CAAC;AAAEE,QAAAA,IAAI,EAAEN,IAAI;AAAA;AAAA;AAAZ,OAAD,C,UAGRI,QAAQ,CAAC;AAAEE,QAAAA,IAAI,EAAEN,IAAI;AAAA;AAAA;AAAZ,OAAD,C,UAGRI,QAAQ,CAACN,IAAD,C,UAGRM,QAAQ,CAACT,KAAD,C,UAGRS,QAAQ,CAACT,KAAD,C,UAGRS,QAAQ,CAACV,IAAD,C,UAGRU,QAAQ,CAACR,MAAD,C,2BA3Bb,MACaS,YADb,SACkCZ,SADlC,CAC4C;AAAA;AAAA;AAAA,eAChCc,UADgC,GACnBN,IAAI,CAACO,cAAL,EADmB;AAAA,eAGhCC,UAHgC;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AAAA,eA6BhCC,OA7BgC,GA6BtB,KA7BsB;AAAA;;AA+B9BC,QAAAA,KAAK,GAAS;AACpB,eAAKF,UAAL,GAAkB,KAAKG,IAAvB;AACH;;AAEMC,QAAAA,IAAI,CAACC,KAAD,EAAgBC,OAAhB,EAAiCC,OAAjC,EAA6D;AACpE,eAAKC,SAAL,CAAeC,MAAf,GAAwBJ,KAAxB;AACA,eAAKK,WAAL,CAAiBD,MAAjB,GAA0BH,OAA1B;AAEA,eAAKK,eAAL,CAAqBC,iBAArB;;AAEA,eAAK,MAAMC,OAAX,IAAsBN,OAAtB,EAA+B;AAC3B,kBAAMO,MAAM,GAAGD,OAAO,CAACE,oBAAR,IAAgC,KAAKC,mBAApD;AACA,kBAAMC,OAAO,GAAG7B,WAAW,CAAC0B,MAAD,CAA3B;AACA,iBAAKH,eAAL,CAAqBO,QAArB,CAA8BD,OAA9B;AAEA,kBAAME,KAAK,GAAGF,OAAO,CAACG,sBAAR,CAA+BlC,KAA/B,CAAd;AACA,gBAAIiC,KAAJ,EAAWA,KAAK,CAACV,MAAN,GAAeI,OAAO,CAACM,KAAvB;AAEXF,YAAAA,OAAO,CAACI,EAAR,CAAWpC,IAAI,CAACqC,SAAL,CAAeC,SAA1B,EAAqC,MAAM;AACvCV,cAAAA,OAAO,CAACW,QAAR,oBAAAX,OAAO,CAACW,QAAR;AACA,mBAAKC,KAAL;AACH,aAHD;AAIH;;AAED,eAAKtB,IAAL,CAAUuB,MAAV,GAAmB,IAAnB;AACA,eAAKC,YAAL;AACA,eAAK1B,OAAL,GAAe,IAAf;AACH;;AAEMwB,QAAAA,KAAK,GAAG;AACX,eAAKG,WAAL,CAAiB,MAAM;AACnB,iBAAKzB,IAAL,CAAUuB,MAAV,GAAmB,KAAnB;AACH,WAFD;AAGA,eAAKzB,OAAL,GAAe,KAAf;AACH;;AAEM4B,QAAAA,KAAK,GAAY;AACpB,iBAAO,KAAK5B,OAAZ;AACH;;AAEO0B,QAAAA,YAAY,CAACG,UAAD,EAA0B;AAC1C,kBAAO,KAAKC,kBAAZ;AACI,iBAAK;AAAA;AAAA,0DAAmBC,SAAxB;AACI,mBAAKhC,UAAL,CAAgBiC,WAAhB,CAA4B,IAAI5C,IAAJ,CAAS,CAAT,EAAY,CAAC,KAAKS,UAAL,CAAgBoC,MAA7B,EAAqC,CAArC,CAA5B;AACA5C,cAAAA,KAAK,CAAC,KAAKU,UAAN,CAAL,CACKmC,EADL,CACQ,KAAKC,iBADb,EACgC;AAAEC,gBAAAA,QAAQ,EAAE,KAAKC;AAAjB,eADhC,EAEKC,IAFL,CAEU,MAAMT,UAAN,oBAAMA,UAAU,EAF1B,EAGK5B,KAHL;AAKA;;AAEJ,iBAAK;AAAA;AAAA,0DAAmBsC,MAAxB;AACI,mBAAKxC,UAAL,CAAgBiC,WAAhB,CAA4B,IAAI5C,IAAJ,CAAS,CAAT,EAAY,KAAKS,UAAL,CAAgBoC,MAA5B,EAAoC,CAApC,CAA5B;AACA5C,cAAAA,KAAK,CAAC,KAAKU,UAAN,CAAL,CACKmC,EADL,CACQ,KAAKC,iBADb,EACgC;AAAEC,gBAAAA,QAAQ,EAAE,KAAKC;AAAjB,eADhC,EAEKC,IAFL,CAEU,MAAMT,UAAN,oBAAMA,UAAU,EAF1B,EAGK5B,KAHL;AAKA;;AAEJ,iBAAK;AAAA;AAAA,0DAAmBuC,OAAxB;AACI,mBAAKzC,UAAL,CAAgBiC,WAAhB,CAA4B,IAAI5C,IAAJ,CAAS,CAAC,KAAKS,UAAL,CAAgB4C,KAA1B,EAAiC,CAAjC,EAAoC,CAApC,CAA5B;AACApD,cAAAA,KAAK,CAAC,KAAKU,UAAN,CAAL,CACKmC,EADL,CACQ,KAAKC,iBADb,EACgC;AAAEC,gBAAAA,QAAQ,EAAE,KAAKC;AAAjB,eADhC,EAEKC,IAFL,CAEU,MAAMT,UAAN,oBAAMA,UAAU,EAF1B,EAGK5B,KAHL;AAKA;;AAEJ,iBAAK;AAAA;AAAA,0DAAmByC,QAAxB;AACI,mBAAK3C,UAAL,CAAgBiC,WAAhB,CAA4B,IAAI5C,IAAJ,CAAS,KAAKS,UAAL,CAAgB4C,KAAzB,EAAgC,CAAhC,EAAmC,CAAnC,CAA5B;AACApD,cAAAA,KAAK,CAAC,KAAKU,UAAN,CAAL,CACKmC,EADL,CACQ,KAAKC,iBADb,EACgC;AAAEC,gBAAAA,QAAQ,EAAE,KAAKC;AAAjB,eADhC,EAEKC,IAFL,CAEU,MAAMT,UAAN,oBAAMA,UAAU,EAF1B,EAGK5B,KAHL;AAKA;;AAEJ,iBAAK;AAAA;AAAA,0DAAmB0C,KAAxB;AACI,mBAAK5C,UAAL,CAAgB6C,QAAhB,CAAyB,IAAIxD,IAAJ,CAAS,CAAT,EAAY,CAAZ,EAAe,CAAf,CAAzB;AACAC,cAAAA,KAAK,CAAC,KAAKU,UAAN,CAAL,CACKmC,EADL,CACQ,KAAKC,iBADb,EACgC;AAAEU,gBAAAA,KAAK,EAAE,IAAIzD,IAAJ,CAAS,CAAT,EAAY,CAAZ,EAAe,CAAf;AAAT,eADhC,EAEKkD,IAFL,CAEU,MAAMT,UAAN,oBAAMA,UAAU,EAF1B,EAGK5B,KAHL;AAKA;AA5CR;AA8CH;;AAEO0B,QAAAA,WAAW,CAACE,UAAD,EAA0B;AACzC,kBAAO,KAAKiB,iBAAZ;AACI,iBAAK;AAAA;AAAA,0DAAmBf,SAAxB;AACI,mBAAKhC,UAAL,CAAgBiC,WAAhB,CAA4B,KAAKK,cAAjC;AACAhD,cAAAA,KAAK,CAAC,KAAKU,UAAN,CAAL,CACKmC,EADL,CACQ,KAAKC,iBADb,EACgC;AAAEC,gBAAAA,QAAQ,EAAE,IAAIhD,IAAJ,CAAS,CAAT,EAAY,CAAC,KAAKS,UAAL,CAAgBoC,MAA7B,EAAqC,CAArC;AAAZ,eADhC,EAEKK,IAFL,CAEU,MAAMT,UAAN,oBAAMA,UAAU,EAF1B,EAGK5B,KAHL;AAKA;;AAEJ,iBAAK;AAAA;AAAA,0DAAmBsC,MAAxB;AACI,mBAAKxC,UAAL,CAAgBiC,WAAhB,CAA4B,KAAKK,cAAjC;AACAhD,cAAAA,KAAK,CAAC,KAAKU,UAAN,CAAL,CACKmC,EADL,CACQ,KAAKC,iBADb,EACgC;AAAEC,gBAAAA,QAAQ,EAAE,IAAIhD,IAAJ,CAAS,CAAT,EAAY,KAAKS,UAAL,CAAgBoC,MAA5B,EAAoC,CAApC;AAAZ,eADhC,EAEKK,IAFL,CAEU,MAAMT,UAAN,oBAAMA,UAAU,EAF1B,EAGK5B,KAHL;AAKA;;AAEJ,iBAAK;AAAA;AAAA,0DAAmBuC,OAAxB;AACI,mBAAKzC,UAAL,CAAgBiC,WAAhB,CAA4B,KAAKK,cAAjC;AACAhD,cAAAA,KAAK,CAAC,KAAKU,UAAN,CAAL,CACKmC,EADL,CACQ,KAAKC,iBADb,EACgC;AAAEC,gBAAAA,QAAQ,EAAE,IAAIhD,IAAJ,CAAS,CAAC,KAAKS,UAAL,CAAgB4C,KAA1B,EAAiC,CAAjC,EAAoC,CAApC;AAAZ,eADhC,EAEKH,IAFL,CAEU,MAAMT,UAAN,oBAAMA,UAAU,EAF1B,EAGK5B,KAHL;AAKA;;AAEJ,iBAAK;AAAA;AAAA,0DAAmByC,QAAxB;AACI,mBAAK3C,UAAL,CAAgBiC,WAAhB,CAA4B,KAAKK,cAAjC;AACAhD,cAAAA,KAAK,CAAC,KAAKU,UAAN,CAAL,CACKmC,EADL,CACQ,KAAKC,iBADb,EACgC;AAAEC,gBAAAA,QAAQ,EAAE,IAAIhD,IAAJ,CAAS,KAAKS,UAAL,CAAgB4C,KAAzB,EAAgC,CAAhC,EAAmC,CAAnC;AAAZ,eADhC,EAEKH,IAFL,CAEU,MAAMT,UAAN,oBAAMA,UAAU,EAF1B,EAGK5B,KAHL;AAKA;;AAEJ,iBAAK;AAAA;AAAA,0DAAmB0C,KAAxB;AACI,mBAAK5C,UAAL,CAAgB6C,QAAhB,CAAyB,IAAIxD,IAAJ,CAAS,CAAT,EAAY,CAAZ,EAAe,CAAf,CAAzB;AACAC,cAAAA,KAAK,CAAC,KAAKU,UAAN,CAAL,CACKmC,EADL,CACQ,KAAKC,iBADb,EACgC;AAAEU,gBAAAA,KAAK,EAAE,IAAIzD,IAAJ,CAAS,CAAT,EAAY,CAAZ,EAAe,CAAf;AAAT,eADhC,EAEKkD,IAFL,CAEU,MAAMT,UAAN,oBAAMA,UAAU,EAF1B,EAGK5B,KAHL;AAKA;AA5CR;AA8CH;;AAvKuC,O,oFAKvCP,Q;;;;;iBAC2B,I;;;;;;;iBAGa;AAAA;AAAA,wDAAmB6C,M;;;;;;;iBAGpB;AAAA;AAAA,wDAAmBA,M;;;;;;;iBAGpC,IAAInD,IAAJ,CAAS,CAAT,EAAY,CAAZ,EAAe,CAAf,C;;;;;;;iBAGJ,I;;;;;;;iBAGE,I;;;;;;;iBAGG,I;;;;;;;iBAGM,I","sourcesContent":["import { _decorator, Component, Node, Label, Prefab, instantiate, Vec3, tween, Enum , view } from 'cc';\nconst { ccclass, property } = _decorator;\n\nimport { PopupButtonData } from './PopupButtonData';\nimport { PopupAnimationType } from '../enums/PopupAnimationType';\n\n@ccclass('GenericPopup')\nexport class GenericPopup extends Component {\n    private screenSize = view.getVisibleSize();\n\n    private popupPanel: Node;\n\n    @property\n    animationDuration: number = 0.75;\n\n    @property({ type: Enum(PopupAnimationType) })\n    entryAnimationType: PopupAnimationType = PopupAnimationType.FlyTop;\n\n    @property({ type: Enum(PopupAnimationType) })\n    exitAnimationType: PopupAnimationType = PopupAnimationType.FlyTop;\n\n    @property(Vec3)\n    onscreenTarget: Vec3 = new Vec3(0, 0, 0);\n\n    @property(Label)\n    titleText: Label = null!;\n\n    @property(Label)\n    messageText: Label = null!;\n\n    @property(Node)\n    buttonContainer: Node = null!;\n\n    @property(Prefab)\n    defaultButtonPrefab: Prefab = null!;\n\n    private isShown = false;\n\n    protected start(): void {\n        this.popupPanel = this.node;\n    }\n\n    public show(title: string, message: string, buttons: PopupButtonData[]) {\n        this.titleText.string = title;\n        this.messageText.string = message;\n\n        this.buttonContainer.removeAllChildren();\n\n        for (const btnData of buttons) {\n            const prefab = btnData.buttonPrefabOverride || this.defaultButtonPrefab;\n            const btnNode = instantiate(prefab);\n            this.buttonContainer.addChild(btnNode);\n\n            const label = btnNode.getComponentInChildren(Label);\n            if (label) label.string = btnData.label;\n\n            btnNode.on(Node.EventType.TOUCH_END, () => {\n                btnData.callback?.();\n                this.close();\n            });\n        }\n\n        this.node.active = true;\n        this.animateEntry();\n        this.isShown = true;\n    }\n\n    public close() {\n        this.animateExit(() => {\n            this.node.active = false;\n        });\n        this.isShown = false;\n    }\n\n    public shown(): boolean {\n        return this.isShown;\n    }\n\n    private animateEntry(onComplete?: () => void) {\n        switch(this.entryAnimationType) {\n            case PopupAnimationType.FlyBottom:\n                this.popupPanel.setPosition(new Vec3(0, -this.screenSize.height, 0));\n                tween(this.popupPanel)\n                    .to(this.animationDuration, { position: this.onscreenTarget })\n                    .call(() => onComplete?.())\n                    .start();\n                \n                break;\n                \n            case PopupAnimationType.FlyTop:\n                this.popupPanel.setPosition(new Vec3(0, this.screenSize.height, 0));\n                tween(this.popupPanel)\n                    .to(this.animationDuration, { position: this.onscreenTarget })\n                    .call(() => onComplete?.())\n                    .start();\n                \n                break;\n                    \n            case PopupAnimationType.FlyLeft:\n                this.popupPanel.setPosition(new Vec3(-this.screenSize.width, 0, 0));\n                tween(this.popupPanel)\n                    .to(this.animationDuration, { position: this.onscreenTarget })\n                    .call(() => onComplete?.())\n                    .start();\n\n                break;\n                        \n            case PopupAnimationType.FlyRight:\n                this.popupPanel.setPosition(new Vec3(this.screenSize.width, 0, 0));\n                tween(this.popupPanel)\n                    .to(this.animationDuration, { position: this.onscreenTarget })\n                    .call(() => onComplete?.())\n                    .start();\n\n                break;\n                            \n            case PopupAnimationType.Scale:\n                this.popupPanel.setScale(new Vec3(0, 0, 1));\n                tween(this.popupPanel)\n                    .to(this.animationDuration, { scale: new Vec3(1, 1, 1) })\n                    .call(() => onComplete?.())\n                    .start();\n                    \n                break;\n        }\n    }\n\n    private animateExit(onComplete?: () => void) {\n        switch(this.exitAnimationType) {\n            case PopupAnimationType.FlyBottom:\n                this.popupPanel.setPosition(this.onscreenTarget);\n                tween(this.popupPanel)\n                    .to(this.animationDuration, { position: new Vec3(0, -this.screenSize.height, 0) })\n                    .call(() => onComplete?.())\n                    .start();\n\n                break;\n\n            case PopupAnimationType.FlyTop:\n                this.popupPanel.setPosition(this.onscreenTarget);\n                tween(this.popupPanel)\n                    .to(this.animationDuration, { position: new Vec3(0, this.screenSize.height, 0) })\n                    .call(() => onComplete?.())\n                    .start();\n\n                break;\n\n            case PopupAnimationType.FlyLeft:\n                this.popupPanel.setPosition(this.onscreenTarget);\n                tween(this.popupPanel)\n                    .to(this.animationDuration, { position: new Vec3(-this.screenSize.width, 0, 0) })\n                    .call(() => onComplete?.())\n                    .start();\n\n                break;\n\n            case PopupAnimationType.FlyRight:\n                this.popupPanel.setPosition(this.onscreenTarget);\n                tween(this.popupPanel)\n                    .to(this.animationDuration, { position: new Vec3(this.screenSize.width, 0, 0) })\n                    .call(() => onComplete?.())\n                    .start();\n\n                break;\n\n            case PopupAnimationType.Scale:\n                this.popupPanel.setScale(new Vec3(1, 1, 1));\n                tween(this.popupPanel)\n                    .to(this.animationDuration, { scale: new Vec3(0, 0, 1) })\n                    .call(() => onComplete?.())\n                    .start();\n\n                break;\n        }\n    }\n}"]}